<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Mafia.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="modules.html">Modules</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Data Structures</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Data Fields</a> &nbsp; <a class="qindex" href="globals.html">Globals</a> &nbsp; </center>
<hr><h1>Mafia.cpp</h1><a href="Mafia_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment"> </span>
00003 <span class="comment">Copyright (c) 2003, Cornell University</span>
00004 <span class="comment">All rights reserved.</span>
00005 <span class="comment"> </span>
00006 <span class="comment">Redistribution and use in source and binary forms, with or without</span>
00007 <span class="comment">modification, are permitted provided that the following conditions are met:</span>
00008 <span class="comment"> </span>
00009 <span class="comment">  - Redistributions of source code must retain the above copyright notice,</span>
00010 <span class="comment">      this list of conditions and the following disclaimer.</span>
00011 <span class="comment">  - Redistributions in binary form must reproduce the above copyright</span>
00012 <span class="comment">      notice, this list of conditions and the following disclaimer in the</span>
00013 <span class="comment">      documentation and/or other materials provided with the distribution.</span>
00014 <span class="comment">  - Neither the name of Cornell University nor the names of its</span>
00015 <span class="comment">      contributors may be used to endorse or promote products derived from</span>
00016 <span class="comment">      this software without specific prior written permission.</span>
00017 <span class="comment"> </span>
00018 <span class="comment">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"</span>
00019 <span class="comment">AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
00020 <span class="comment">IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span>
00021 <span class="comment">ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE</span>
00022 <span class="comment">LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR</span>
00023 <span class="comment">CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF</span>
00024 <span class="comment">SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</span>
00025 <span class="comment">INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN</span>
00026 <span class="comment">CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</span>
00027 <span class="comment">ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF</span>
00028 <span class="comment">THE POSSIBILITY OF SUCH DAMAGE.</span>
00029 <span class="comment"> </span>
00030 <span class="comment">*/</span>
00031 <span class="comment"></span>
00032 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
00033 <span class="comment"></span><span class="comment">//</span>
00034 <span class="comment">// Mafia.cpp</span>
00035 <span class="comment">//</span><span class="comment"></span>
00036 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
00037 <span class="comment"></span>
00038 <span class="comment">//#define DEBUG</span>
00039 
00040 <span class="preprocessor">#include &lt;iostream&gt;</span>
00041 <span class="preprocessor">#include &lt;fstream&gt;</span>
00042 <span class="preprocessor">#include &lt;time.h&gt;</span>
00043 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00044 <span class="preprocessor">#include &lt;list&gt;</span>
00045 <span class="preprocessor">#include &lt;vector&gt;</span>
00046 <span class="preprocessor">#include &lt;algorithm&gt;</span>
00047 <span class="preprocessor">#include &lt;string&gt;</span>
00048 <span class="preprocessor">#include &lt;assert.h&gt;</span>
00049 <span class="preprocessor">#include &lt;math.h&gt;</span>
00050 <span class="preprocessor">#include &lt;map&gt;</span>
00051 <span class="preprocessor">#include "<a class="code" href="Bitmap_8h.html">Bitmap.h</a>"</span>
00052 <span class="preprocessor">#include "<a class="code" href="TreeNode_8h.html">TreeNode.h</a>"</span>
00053 <span class="preprocessor">#include "<a class="code" href="Transaction_8h.html">Transaction.h</a>"</span>
00054 <span class="preprocessor">#include "<a class="code" href="ItemsetOutput_8h.html">ItemsetOutput.h</a>"</span>
00055 
00056 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00057 <span class="comment"></span>
00058 <span class="comment">/// @defgroup GlobalVariables Global Variables</span>
00059 <span class="comment">/// Global variables</span>
00060 <span class="comment"></span><span class="comment">/** @{ */</span>
<a name="l00061"></a><a class="code" href="group__GlobalVariables.html#a0">00061</a> <span class="keyword">typedef</span> vector&lt;TreeNode *&gt; <a class="code" href="group__GlobalVariables.html#a0">NodeList</a>;
<a name="l00062"></a><a class="code" href="group__GlobalVariables.html#a1">00062</a> <span class="keyword">typedef</span> vector&lt;TreeNode *&gt; <a class="code" href="group__GlobalVariables.html#a1">BranchList</a>;
<a name="l00063"></a><a class="code" href="group__GlobalVariables.html#a2">00063</a> <span class="keyword">typedef</span> vector&lt;Bitmap *&gt; <a class="code" href="group__GlobalVariables.html#a2">BitmapList</a>;
<a name="l00064"></a><a class="code" href="group__GlobalVariables.html#a3">00064</a> <span class="keyword">typedef</span> vector&lt;BaseBitmap *&gt; <a class="code" href="group__GlobalVariables.html#a3">BaseBitmapList</a>;
<a name="l00065"></a><a class="code" href="group__GlobalVariables.html#a4">00065</a> <span class="keyword">typedef</span> vector&lt;int&gt; <a class="code" href="group__GlobalVariables.html#a4">ItemSet</a>;
<a name="l00066"></a><a class="code" href="group__GlobalVariables.html#a5">00066</a> <span class="keyword">typedef</span> map&lt;long, ItemSet *&gt; <a class="code" href="group__GlobalVariables.html#a5">HashTable</a>;
00067 <span class="comment"></span>
00068 <span class="comment">/// Simple class for storing subtree size estimates</span>
<a name="l00069"></a><a class="code" href="classSubtreeEstimate.html">00069</a> <span class="comment"></span><span class="keyword">class </span><a class="code" href="classSubtreeEstimate.html">SubtreeEstimate</a> {
00070 <span class="keyword">public</span>:
<a name="l00071"></a><a class="code" href="classSubtreeEstimate.html#SubtreeEstimatem0">00071</a>     <span class="keywordtype">int</span> <a class="code" href="classSubtreeEstimate.html#SubtreeEstimatem0">Count</a>;              <span class="comment">///&lt; Count of actual subtrees counted</span>
<a name="l00072"></a><a class="code" href="classSubtreeEstimate.html#SubtreeEstimatem1">00072</a> <span class="comment"></span>    <span class="keywordtype">int</span> <a class="code" href="classSubtreeEstimate.html#SubtreeEstimatem1">Sum</a>;                <span class="comment">///&lt; Sum of subtree sizes</span>
<a name="l00073"></a><a class="code" href="classSubtreeEstimate.html#SubtreeEstimatea0">00073</a> <span class="comment"></span>    <a class="code" href="classSubtreeEstimate.html#SubtreeEstimatea0">SubtreeEstimate</a> () {
00074         <a class="code" href="classSubtreeEstimate.html#SubtreeEstimatem0">Count</a> = 0;
00075         <a class="code" href="classSubtreeEstimate.html#SubtreeEstimatem1">Sum</a> = 0;
00076     }
00077 };
00078 <span class="comment"></span>
00079 <span class="comment">/// Simple class for storing tail elements of each node of the tree</span>
<a name="l00080"></a><a class="code" href="classTailElement.html">00080</a> <span class="comment"></span><span class="keyword">class </span><a class="code" href="classTailElement.html">TailElement</a> {
00081 <span class="keyword">public</span>:
<a name="l00082"></a><a class="code" href="classTailElement.html#TailElementm0">00082</a>     <span class="keywordtype">int</span> <a class="code" href="classTailElement.html#TailElementm0">Count</a>;              <span class="comment">///&lt; Support of the 1-extension</span>
<a name="l00083"></a><a class="code" href="classTailElement.html#TailElementm1">00083</a> <span class="comment"></span>    <span class="keywordtype">int</span> <a class="code" href="classTailElement.html#TailElementm1">Item</a>;               <span class="comment">///&lt; Item-id for this1 -extension</span>
00084 <span class="comment"></span>
<a name="l00085"></a><a class="code" href="classTailElement.html#TailElementa0">00085</a>     <a class="code" href="classTailElement.html#TailElementa0">TailElement</a> () {
00086         <a class="code" href="classTailElement.html#TailElementm0">Count</a> = 0;
00087         <a class="code" href="classTailElement.html#TailElementm1">Item</a> = 0;
00088     }
00089 
<a name="l00090"></a><a class="code" href="classTailElement.html#TailElementa1">00090</a>     <span class="keywordtype">bool</span> <a class="code" href="classTailElement.html#TailElementa1">operator &lt; </a>(<span class="keyword">const</span> <a class="code" href="classTailElement.html">TailElement</a>&amp; rhs)<span class="keyword"> const </span>{
00091         <span class="keywordflow">return</span> this-&gt;<a class="code" href="classTailElement.html#TailElementm0">Count</a> &lt; rhs.<a class="code" href="classTailElement.html#TailElementm0">Count</a>;
00092     };
00093 };
00094 <span class="comment"></span>
00095 <span class="comment">/// @defgroup CommandLineParameters Command Line Parameters/Variables</span>
00096 <span class="comment">/// Commmand line parameters from user or inferred</span>
00097 <span class="comment"></span><span class="comment">/** @{ */</span>
<a name="l00098"></a><a class="code" href="group__CommandLineParameters.html#a0">00098</a> string <a class="code" href="group__CommandLineParameters.html#a0">method</a>;               <span class="comment">///&lt; either -mfi or -fci or -fi</span>
<a name="l00099"></a><a class="code" href="group__CommandLineParameters.html#a1">00099</a> <span class="comment"></span><span class="keywordtype">char</span>* <a class="code" href="group__CommandLineParameters.html#a1">outFilename</a>;           <span class="comment">///&lt; filename for output</span>
<a name="l00100"></a><a class="code" href="group__CommandLineParameters.html#a2">00100</a> <span class="comment"></span><a class="code" href="classItemsetOutput.html">ItemsetOutput</a> *<a class="code" href="group__CommandLineParameters.html#a2">outFile</a>;      <span class="comment">///&lt; file for ouput</span>
<a name="l00101"></a><a class="code" href="group__CommandLineParameters.html#a3">00101</a> <span class="comment"></span><span class="keywordtype">bool</span> <a class="code" href="group__CommandLineParameters.html#a3">outputMFI</a> = <span class="keyword">false</span>;      <span class="comment">///&lt; true if MFI should be saved to a file</span>
<a name="l00102"></a><a class="code" href="group__CommandLineParameters.html#a4">00102</a> <span class="comment"></span><span class="keywordtype">bool</span> <a class="code" href="group__CommandLineParameters.html#a4">MethodIsFI</a> = <span class="keyword">false</span>;     <span class="comment">///&lt; true if the method is -fi</span>
<a name="l00103"></a><a class="code" href="group__CommandLineParameters.html#a5">00103</a> <span class="comment"></span><span class="keywordtype">bool</span> <a class="code" href="group__CommandLineParameters.html#a5">MethodIsFCI</a> = <span class="keyword">false</span>;    <span class="comment">///&lt; true if the method is -fci</span>
<a name="l00104"></a><a class="code" href="group__CommandLineParameters.html#a6">00104</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__CommandLineParameters.html#a6">ItemCount</a>;               <span class="comment">///&lt; # of items in the file</span>
<a name="l00105"></a><a class="code" href="group__CommandLineParameters.html#a7">00105</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__CommandLineParameters.html#a7">TransCount</a>;              <span class="comment">///&lt; # of transactions in the file</span>
<a name="l00106"></a><a class="code" href="group__CommandLineParameters.html#a8">00106</a> <span class="comment"></span><span class="keywordtype">double</span> <a class="code" href="group__CommandLineParameters.html#a8">MSF</a>;                  <span class="comment">///&lt; user-defined min sup as percentage</span>
<a name="l00107"></a><a class="code" href="group__CommandLineParameters.html#a9">00107</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__CommandLineParameters.html#a9">MS</a>;                      <span class="comment">///&lt; min sup as a transaction count</span>
<a name="l00108"></a><a class="code" href="group__CommandLineParameters.html#a10">00108</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__CommandLineParameters.html#a10">VerScale</a> = 1;            <span class="comment">///&lt; Scaling factor for transactions</span>
<a name="l00109"></a><a class="code" href="group__CommandLineParameters.html#a11">00109</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__CommandLineParameters.html#a11">HorScale</a> = 1;            <span class="comment">///&lt; Scaling factor for items</span>
<a name="l00110"></a><a class="code" href="group__CommandLineParameters.html#a12">00110</a> <span class="comment"></span><span class="keywordtype">bool</span> <a class="code" href="group__CommandLineParameters.html#a12">GoFHUT</a> = <span class="keyword">true</span>;          <span class="comment">///&lt; FHUT flag</span>
<a name="l00111"></a><a class="code" href="group__CommandLineParameters.html#a13">00111</a> <span class="comment"></span><span class="keywordtype">bool</span> <a class="code" href="group__CommandLineParameters.html#a13">HUTMFI</a> = <span class="keyword">true</span>;          <span class="comment">///&lt; HUTMFI flag</span>
<a name="l00112"></a><a class="code" href="group__CommandLineParameters.html#a14">00112</a> <span class="comment"></span><span class="keywordtype">bool</span> <a class="code" href="group__CommandLineParameters.html#a14">PEPrune</a> = <span class="keyword">true</span>;         <span class="comment">///&lt; PEPrune flag -- parent equivalent pruning</span>
<a name="l00113"></a><a class="code" href="group__CommandLineParameters.html#a15">00113</a> <span class="comment"></span><span class="keywordtype">bool</span> <a class="code" href="group__CommandLineParameters.html#a15">Reorder</a> = <span class="keyword">true</span>;         <span class="comment">///&lt; Reorder flag</span>
00114 <span class="comment"></span><span class="comment">/** @} */</span>
00115 
00116 <span class="comment"></span>
00117 <span class="comment">/// @defgroup CounterVariables Counter Variables</span>
00118 <span class="comment">/// Counter variables for information gathering</span>
00119 <span class="comment"></span><span class="comment">/** @{ */</span>
<a name="l00120"></a><a class="code" href="group__CounterVariables.html#a0">00120</a> <span class="keywordtype">int</span> <a class="code" href="group__CounterVariables.html#a0">CountFHUT</a> = 0;           <span class="comment">///&lt; # of times FHUT was successful</span>
<a name="l00121"></a><a class="code" href="group__CounterVariables.html#a1">00121</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__CounterVariables.html#a1">CountNodes</a> = 0;          <span class="comment">///&lt; # of frequent nodes in the tree</span>
<a name="l00122"></a><a class="code" href="group__CounterVariables.html#a2">00122</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__CounterVariables.html#a2">CountCounts</a> = 0;         <span class="comment">///&lt; # of Counts or all nodes in the tree</span>
<a name="l00123"></a><a class="code" href="group__CounterVariables.html#a3">00123</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__CounterVariables.html#a3">CountAnds</a> = 0;           <span class="comment">///&lt; # of ANDs of normal bitmaps</span>
<a name="l00124"></a><a class="code" href="group__CounterVariables.html#a4">00124</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__CounterVariables.html#a4">CountSmallAnds</a> = 0;      <span class="comment">///&lt; # of compressed bitmap ANDs</span>
<a name="l00125"></a><a class="code" href="group__CounterVariables.html#a5">00125</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__CounterVariables.html#a5">CountPEPrunes</a> = 0;         <span class="comment">///&lt; # of PEPruning</span>
<a name="l00126"></a><a class="code" href="group__CounterVariables.html#a6">00126</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__CounterVariables.html#a6">CountCheckPosition</a> = 0;  <span class="comment">///&lt; # of CheckPosition calls</span>
<a name="l00127"></a><a class="code" href="group__CounterVariables.html#a7">00127</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__CounterVariables.html#a7">CountHUTMFI</a> = 0;         <span class="comment">///&lt; # of HUTMFI attempts</span>
<a name="l00128"></a><a class="code" href="group__CounterVariables.html#a8">00128</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__CounterVariables.html#a8">CountHUTMFISuccess</a> = 0;  <span class="comment">///&lt; # of HUTMFI successes</span>
<a name="l00129"></a><a class="code" href="group__CounterVariables.html#a9">00129</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__CounterVariables.html#a9">CountRebuilds</a>;           <span class="comment">///&lt; # of Rebuilds</span>
00130 <span class="comment"></span><span class="comment">/** @} */</span>
00131 
00132 <span class="comment"></span>
00133 <span class="comment">/// @defgroup ProgramVariables Program Parameters/Variables</span>
00134 <span class="comment">/// Useful program parameters/counters</span>
00135 <span class="comment"></span><span class="comment">/** @{ */</span>
<a name="l00136"></a><a class="code" href="group__ProgramVariables.html#a0">00136</a> <span class="keywordtype">int</span> <a class="code" href="group__ProgramVariables.html#a0">maxtail</a> = 0;
<a name="l00137"></a><a class="code" href="group__ProgramVariables.html#a1">00137</a> <span class="keywordtype">int</span> <a class="code" href="group__ProgramVariables.html#a1">MFISize</a> = 0;             <span class="comment">///&lt; MFI size before pruning</span>
<a name="l00138"></a><a class="code" href="group__ProgramVariables.html#a2">00138</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__ProgramVariables.html#a2">MFIDepth</a> = 0;            <span class="comment">///&lt; The aggregated depth of the all MFI elements</span>
<a name="l00139"></a><a class="code" href="group__ProgramVariables.html#a3">00139</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__ProgramVariables.html#a3">F1size</a> = 0;              <span class="comment">///&lt; # of frequent 1-itemsets after merging repeats</span>
<a name="l00140"></a><a class="code" href="group__ProgramVariables.html#a4">00140</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__ProgramVariables.html#a4">FullF1size</a> = 0;          <span class="comment">///&lt; # of frequent 1-itemsets</span>
<a name="l00141"></a><a class="code" href="group__ProgramVariables.html#a5">00141</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__ProgramVariables.html#a5">k</a> = 50;                  <span class="comment">///&lt; # of items checked for a MFI lookup</span>
<a name="l00142"></a><a class="code" href="group__ProgramVariables.html#a6">00142</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__ProgramVariables.html#a6">MAX_compID</a> = 1;          <span class="comment">///&lt; max compression ID</span>
<a name="l00143"></a><a class="code" href="group__ProgramVariables.html#a7">00143</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__ProgramVariables.html#a7">projectDepth</a> = -1;       <span class="comment">///&lt; depth of the bitmap you're projecting from</span>
<a name="l00144"></a><a class="code" href="group__ProgramVariables.html#a8">00144</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__ProgramVariables.html#a8">EstimateSize</a>;            <span class="comment">///&lt; size of subtree estimation buffer</span>
<a name="l00145"></a><a class="code" href="group__ProgramVariables.html#a9">00145</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__ProgramVariables.html#a9">EstimateDiv</a> = 5;         <span class="comment">///&lt; bucket size by frequent tail length</span>
<a name="l00146"></a><a class="code" href="group__ProgramVariables.html#a10">00146</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="group__ProgramVariables.html#a10">maxItemsetSize</a> = 0;      <span class="comment">///&lt; max size of a frequent itemset</span>
00147 <span class="comment"></span><span class="comment">/** @} */</span>
00148 
00149 <span class="comment"></span>
00150 <span class="comment">/// @defgroup DataVariables Data variables</span>
00151 <span class="comment">/// Complex data structure variables</span>
00152 <span class="comment"></span><span class="comment">/** @{ */</span>
<a name="l00153"></a><a class="code" href="group__DataVariables.html#a0">00153</a> <a class="code" href="group__GlobalVariables.html#a0">NodeList</a> <a class="code" href="group__DataVariables.html#a0">F1</a>;                 <span class="comment">///&lt; List of frequent 1-itemsets</span>
<a name="l00154"></a><a class="code" href="group__DataVariables.html#a1">00154</a> <span class="comment"></span><a class="code" href="group__GlobalVariables.html#a2">BitmapList</a> <a class="code" href="group__DataVariables.html#a1">TransBuffy</a>;       <span class="comment">///&lt; Buffer of transaction bitmaps</span>
<a name="l00155"></a><a class="code" href="group__DataVariables.html#a2">00155</a> <span class="comment"></span><a class="code" href="group__GlobalVariables.html#a3">BaseBitmapList</a> <a class="code" href="group__DataVariables.html#a2">NameBuffy</a>;    <span class="comment">///&lt; Buffer of name bitmaps</span>
<a name="l00156"></a><a class="code" href="group__DataVariables.html#a3">00156</a> <span class="comment"></span><a class="code" href="group__GlobalVariables.html#a0">NodeList</a> <a class="code" href="group__DataVariables.html#a3">NodeBuffy</a>;          <span class="comment">///&lt; Buffer of tree nodess</span>
<a name="l00157"></a><a class="code" href="group__DataVariables.html#a4">00157</a> <span class="comment"></span><a class="code" href="classTreeNode.html">TreeNode</a> *<a class="code" href="group__DataVariables.html#a4">Root</a>;              <span class="comment">///&lt; The root (the nullset)</span>
<a name="l00158"></a><a class="code" href="group__DataVariables.html#a5">00158</a> <span class="comment"></span><a class="code" href="classTailElement.html">TailElement</a> *<a class="code" href="group__DataVariables.html#a5">gTail</a>;          <span class="comment">///&lt; global tail pointer</span>
<a name="l00159"></a><a class="code" href="group__DataVariables.html#a6">00159</a> <span class="comment"></span><a class="code" href="classTailElement.html">TailElement</a> *<a class="code" href="group__DataVariables.html#a6">TailBuffy</a>;      <span class="comment">///&lt; Common Buffer for tail elements</span>
<a name="l00160"></a><a class="code" href="group__DataVariables.html#a7">00160</a> <span class="comment"></span><a class="code" href="classBitmap.html">Bitmap</a> *<a class="code" href="group__DataVariables.html#a7">NullTrans</a>;           <span class="comment">///&lt; A transaction bitmap filled with ones</span>
<a name="l00161"></a><a class="code" href="group__DataVariables.html#a8">00161</a> <span class="comment"></span><span class="keywordtype">int</span> *<a class="code" href="group__DataVariables.html#a8">ItemMap</a>;                <span class="comment">///&lt; For renaming items after sorting by support</span>
<a name="l00162"></a><a class="code" href="group__DataVariables.html#a9">00162</a> <span class="comment"></span><span class="keywordtype">int</span> *<a class="code" href="group__DataVariables.html#a9">ReverseItemMap</a>;         <span class="comment">///&lt; For remembering the renaming...</span>
<a name="l00163"></a><a class="code" href="group__DataVariables.html#a10">00163</a> <span class="comment"></span><a class="code" href="group__GlobalVariables.html#a3">BaseBitmapList</a> <a class="code" href="group__DataVariables.html#a10">MFI</a>;          <span class="comment">///&lt; List of Maximally Frequent Itemsets</span>
<a name="l00164"></a><a class="code" href="group__DataVariables.html#a11">00164</a> <span class="comment"></span><a class="code" href="group__GlobalVariables.html#a5">HashTable</a> <a class="code" href="group__DataVariables.html#a11">HT</a>;                <span class="comment">///&lt; Hash table of transaction supports</span>
<a name="l00165"></a><a class="code" href="group__DataVariables.html#a12">00165</a> <span class="comment"></span>vector &lt;int&gt; <a class="code" href="group__DataVariables.html#a12">SupportCountList</a>;       <span class="comment">///&lt; List that stores support count</span>
<a name="l00166"></a><a class="code" href="group__DataVariables.html#a13">00166</a> <span class="comment"></span><a class="code" href="classBaseBitmap.html">BaseBitmap</a>* <a class="code" href="group__DataVariables.html#a13">TempName</a>;        <span class="comment">///&lt; Temporary buffer for one name bitmap</span>
<a name="l00167"></a><a class="code" href="group__DataVariables.html#a14">00167</a> <span class="comment"></span><a class="code" href="classSubtreeEstimate.html">SubtreeEstimate</a>* <a class="code" href="group__DataVariables.html#a14">EstimateBuffy</a>;      <span class="comment">///&lt; Buffer of subtree estimates</span>
<a name="l00168"></a><a class="code" href="group__DataVariables.html#a15">00168</a> <span class="comment"></span><span class="keywordtype">int</span> *<a class="code" href="group__DataVariables.html#a15">MFIBySizes</a>;             <span class="comment">///&lt; Buffer for counting MFI by itemset size</span>
<a name="l00169"></a><a class="code" href="group__DataVariables.html#a16">00169</a> <span class="comment"></span><span class="keywordtype">int</span> *<a class="code" href="group__DataVariables.html#a16">ItemsetBuffy</a>;           <span class="comment">///&lt; Buffer for writing itemsets to file output</span>
00170 <span class="comment"></span><span class="comment">/** @} */</span>
00171 
00172 <span class="comment"></span>
00173 <span class="comment">/// @defgroup TimingVariables Timing Variables</span>
00174 <span class="comment">/// Variables for timing (and instrumenting the code)</span>
00175 <span class="comment"></span><span class="comment">/** @{ */</span>
<a name="l00176"></a><a class="code" href="group__TimingVariables.html#a0">00176</a> time_t <a class="code" href="group__TimingVariables.html#a0">total_start</a>, <a class="code" href="group__TimingVariables.html#a1">total_finish</a>;
<a name="l00177"></a><a class="code" href="group__TimingVariables.html#a2">00177</a> <span class="keywordtype">double</span> <a class="code" href="group__TimingVariables.html#a2">total_time</a>;
<a name="l00178"></a><a class="code" href="group__TimingVariables.html#a3">00178</a> time_t <a class="code" href="group__TimingVariables.html#a3">read_start</a>, <a class="code" href="group__TimingVariables.html#a4">read_finish</a>;
<a name="l00179"></a><a class="code" href="group__TimingVariables.html#a5">00179</a> <span class="keywordtype">double</span> <a class="code" href="group__TimingVariables.html#a5">read_time</a>;
<a name="l00180"></a><a class="code" href="group__TimingVariables.html#a6">00180</a> time_t <a class="code" href="group__TimingVariables.html#a6">algorithm_start</a>, <a class="code" href="group__TimingVariables.html#a7">algorithm_finish</a>;
<a name="l00181"></a><a class="code" href="group__TimingVariables.html#a8">00181</a> <span class="keywordtype">double</span> <a class="code" href="group__TimingVariables.html#a8">algorithm_time</a>;
<a name="l00182"></a><a class="code" href="group__TimingVariables.html#a9">00182</a> time_t <a class="code" href="group__TimingVariables.html#a9">print_start</a>, <a class="code" href="group__TimingVariables.html#a10">print_finish</a>;
<a name="l00183"></a><a class="code" href="group__TimingVariables.html#a11">00183</a> <span class="keywordtype">double</span> <a class="code" href="group__TimingVariables.html#a11">print_time</a>;<span class="comment"></span>
00184 <span class="comment">/** @} */</span><span class="comment"></span>
00185 <span class="comment">/** @} */</span>
00186 
00187 <span class="comment">/*********************************************************************</span>
00188 <span class="comment"> Reading the data in and building the item bitmaps</span>
00189 <span class="comment">*********************************************************************/</span><span class="comment"></span>
00190 <span class="comment">/// @addtogroup InputOutput Input/Output Functions</span>
00191 <span class="comment">/// Reading the data in and building the item bitmaps.</span>
00192 <span class="comment">/// Outputting the frequent itemsets.</span>
00193 <span class="comment"></span><span class="comment">/** @{ */</span>
00194 <span class="comment"></span>
00195 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
00196 <span class="comment">/// Insert pointer to node in order of increasing support</span>
00197 <span class="comment">///</span>
00198 <span class="comment">/// @param newNode           item node to add to F1</span>
00199 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
<a name="l00200"></a><a class="code" href="group__InputOutput.html#a0">00200</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="group__InputOutput.html#a0">AddToF1</a>(<a class="code" href="classTreeNode.html">TreeNode</a> *newNode) {
00201     <span class="keywordflow">if</span> (<a class="code" href="group__DataVariables.html#a0">F1</a>.empty())
00202         <a class="code" href="group__DataVariables.html#a0">F1</a>.push_back(newNode);
00203     <span class="keywordflow">else</span> {
00204         <span class="comment">// use insertion sort for increasing support ordering</span>
00205         NodeList::iterator noli = <a class="code" href="group__DataVariables.html#a0">F1</a>.begin();
00206         <span class="keywordflow">while</span> (noli != <a class="code" href="group__DataVariables.html#a0">F1</a>.end()) {
00207             <span class="keywordflow">if</span> ((*noli)-&gt;Trans-&gt;_count &gt;= newNode-&gt;<a class="code" href="classTreeNode.html#TreeNodem1">Trans</a>-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a>) {
00208                 <a class="code" href="group__DataVariables.html#a0">F1</a>.insert(noli, newNode);
00209                 <span class="keywordflow">return</span> ;
00210             }
00211             noli++;
00212         }
00213 
00214         <span class="comment">// Add to end of F1 list</span>
00215         <a class="code" href="group__DataVariables.html#a0">F1</a>.push_back(newNode);
00216     }
00217 }
00218 <span class="comment"></span>
00219 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
00220 <span class="comment">/// Create bitmaps filled randomly with probability p</span>
00221 <span class="comment">///</span>
00222 <span class="comment">/// @param P - probability of a bit p being set</span>
00223 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
<a name="l00224"></a><a class="code" href="group__InputOutput.html#a1">00224</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="group__InputOutput.html#a1">F1UsingProb</a>(<span class="keywordtype">double</span> P) {
00225     <span class="keywordtype">int</span> blah = 0;
00226     <span class="comment">//cout &lt;&lt; "Creating bitmap with prob p=" &lt;&lt; P &lt;&lt; endl;</span>
00227 
00228     <span class="comment">// Create frequent 1-itemsets with probability p</span>
00229     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="group__CommandLineParameters.html#a6">ItemCount</a> / <a class="code" href="group__CommandLineParameters.html#a11">HorScale</a>; i++) {
00230         <span class="comment">// Create random transaction bitmap</span>
00231         <a class="code" href="classBitmap.html">Bitmap</a> *trans = <span class="keyword">new</span> <a class="code" href="classBitmap.html">Bitmap</a>(<a class="code" href="group__CommandLineParameters.html#a7">TransCount</a>);
00232         trans-&gt;<a class="code" href="group__BitmapProcessing.html#a3">FillRand</a>(P);
00233 
00234         <span class="comment">// Add frequent items to list</span>
00235         <span class="keywordflow">if</span> (trans-&gt;<a class="code" href="classBitmap.html#Bitmapl0">Count</a>(blah) &gt;= <a class="code" href="group__CommandLineParameters.html#a9">MS</a>) {
00236             <a class="code" href="classTreeNode.html">TreeNode</a> *node = <span class="keyword">new</span> <a class="code" href="classTreeNode.html">TreeNode</a>(NULL, trans, 1, -1, i, -1, 0);
00237             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; <a class="code" href="group__CommandLineParameters.html#a11">HorScale</a>; r++)
00238                 <a class="code" href="group__InputOutput.html#a0">AddToF1</a>(node);
00239         } <span class="keywordflow">else</span>
00240             <span class="keyword">delete</span> trans;
00241     }
00242 }
00243 <span class="comment"></span>
00244 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
00245 <span class="comment">/// Read transaction data from file and build item bitmaps.</span>
00246 <span class="comment">///     If the data is in ascii form:</span>
00247 <span class="comment">///     [itemid_1] [itemid_2] ... [itemid_n]</span>
00248 <span class="comment">///     If the data is in binary form:</span>
00249 <span class="comment">///     [custid] [transid] [number of items] [itemid_1] [itemid_2] ... [itemid_n]</span>
00250 <span class="comment">///</span>
00251 <span class="comment">/// @param filename          name of file to be read in</span>
00252 <span class="comment">/// @param isAsciiFile       true for ASCII input, false for binary</span>
00253 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
<a name="l00254"></a><a class="code" href="group__InputOutput.html#a2">00254</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="group__InputOutput.html#a2">F1FromFile</a>(<span class="keywordtype">char</span> *filename, <span class="keywordtype">bool</span> isAsciiFile) {
00255     <a class="code" href="group__CommandLineParameters.html#a7">TransCount</a> = 0;
00256     <span class="keywordtype">int</span> MAXitemID = -1;
00257     <span class="keywordtype">int</span> *Counters = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="Transaction_8h.html#a0">MAX_NUM_ITEMS</a>];        <span class="comment">//to count the support of items</span>
00258     <span class="keywordtype">int</span> *F1IndexList = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="Transaction_8h.html#a0">MAX_NUM_ITEMS</a>];     <span class="comment">// the id's of F1 items</span>
00259     <span class="keywordtype">int</span> *InvF1IndexList = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="Transaction_8h.html#a0">MAX_NUM_ITEMS</a>];
00260     <span class="keywordtype">int</span> itemIndex = 0;
00261 
00262     <span class="comment">//Initialize counters</span>
00263     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ct = 0; ct &lt; <a class="code" href="Transaction_8h.html#a0">MAX_NUM_ITEMS</a>; ++ct) {
00264         Counters[ct] = 0;
00265         F1IndexList[ct] = -1;
00266         InvF1IndexList[ct] = -1;
00267     }
00268 
00269     time(&amp;<a class="code" href="group__TimingVariables.html#a3">read_start</a>);
00270     <a class="code" href="group__GlobalVariables.html#a2">BitmapList</a> Trans;
00271 
00272     <span class="keywordtype">int</span> *itemlist = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="Transaction_8h.html#a0">MAX_NUM_ITEMS</a>];
00273     <a class="code" href="classInputData.html">InputData</a> *inData = <span class="keyword">new</span> <a class="code" href="classInputData.html">InputData</a>(filename, itemlist, isAsciiFile);
00274     <span class="keywordflow">if</span> (!inData-&gt;<a class="code" href="group__InputOutput.html#a11">isOpen</a>()) {
00275         cerr &lt;&lt; <span class="stringliteral">"Input file not found!"</span> &lt;&lt; endl;
00276         exit(1);
00277     }
00278 
00279     <a class="code" href="classTransaction.html">Transaction</a> *newTransaction = inData-&gt;<a class="code" href="group__InputOutput.html#a8">getNextTransaction</a>();
00280     <span class="keywordflow">while</span> (newTransaction != NULL) {
00281         <span class="keywordflow">for</span> (itemIndex = 0; itemIndex &lt; newTransaction-&gt;<a class="code" href="classTransaction.html#Transactionm0">length</a>; itemIndex++) {
00282             <span class="comment">// ensure that there are not too many items</span>
00283             <span class="keywordflow">if</span> (newTransaction-&gt;<a class="code" href="classTransaction.html#Transactionm1">itemlist</a>[itemIndex] &gt;= <a class="code" href="Transaction_8h.html#a0">MAX_NUM_ITEMS</a>) {
00284                 cerr &lt;&lt; <span class="stringliteral">"Read item_id="</span> &lt;&lt; newTransaction-&gt;<a class="code" href="classTransaction.html#Transactionm1">itemlist</a>[itemIndex]
00285                 &lt;&lt; <span class="stringliteral">" which is more than the max item_id allowed ("</span> &lt;&lt; <a class="code" href="Transaction_8h.html#a0">MAX_NUM_ITEMS</a> &lt;&lt; <span class="stringliteral">")"</span>;
00286                 exit(1);
00287             }
00288 
00289             <span class="keywordflow">if</span> (newTransaction-&gt;<a class="code" href="classTransaction.html#Transactionm1">itemlist</a>[itemIndex] &gt; MAXitemID)
00290                 MAXitemID = newTransaction-&gt;<a class="code" href="classTransaction.html#Transactionm1">itemlist</a>[itemIndex];
00291 
00292             Counters[newTransaction-&gt;<a class="code" href="classTransaction.html#Transactionm1">itemlist</a>[itemIndex]]++;
00293         }
00294 
00295         <a class="code" href="group__CommandLineParameters.html#a7">TransCount</a>++;
00296         <span class="keyword">delete</span> newTransaction;
00297         newTransaction = inData-&gt;<a class="code" href="group__InputOutput.html#a8">getNextTransaction</a>();
00298     }
00299 
00300     <span class="keyword">delete</span> newTransaction;
00301     <span class="keyword">delete</span> inData;
00302 
00303     <a class="code" href="group__CommandLineParameters.html#a9">MS</a> = (int)ceil(<a class="code" href="group__CommandLineParameters.html#a8">MSF</a> * (<span class="keywordtype">double</span>)<a class="code" href="group__CommandLineParameters.html#a7">TransCount</a>);
00304     <span class="comment">//MSF = MS/(double)TransCount;</span>
00305 
00306     <a class="code" href="group__CommandLineParameters.html#a6">ItemCount</a> = MAXitemID + 1;
00307 
00308     <span class="keywordtype">int</span> F1items = 0;
00309     <span class="comment">// build the normal bitmaps -- Preallocated memory for the bitmaps</span>
00310     <span class="keywordflow">for</span> (itemIndex = 0; itemIndex &lt;= MAXitemID; itemIndex++) {
00311         <span class="keywordflow">if</span> (Counters[itemIndex] &gt;= <a class="code" href="group__CommandLineParameters.html#a9">MS</a>) {
00312             F1IndexList[F1items++] = itemIndex;
00313             InvF1IndexList[itemIndex] = F1items - 1;
00314             <a class="code" href="classBitmap.html">Bitmap</a> *trans = <span class="keyword">new</span> <a class="code" href="classBitmap.html">Bitmap</a>(<a class="code" href="group__CommandLineParameters.html#a7">TransCount</a>);
00315             trans-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a> = Counters[itemIndex];
00316             Trans.push_back(trans);
00317         }
00318     }
00319 
00320     <span class="keywordtype">int</span> transIndex = 0;
00321     InputData *inData2 = <span class="keyword">new</span> InputData(filename, itemlist, isAsciiFile);
00322     newTransaction = inData2-&gt;<a class="code" href="group__InputOutput.html#a8">getNextTransaction</a>();
00323     <span class="keywordflow">while</span> (newTransaction != NULL) {
00324         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itemIndex = 0; itemIndex &lt; newTransaction-&gt;<a class="code" href="classTransaction.html#Transactionm0">length</a>; itemIndex++) {
00325             <span class="keywordflow">if</span> (InvF1IndexList[newTransaction-&gt;<a class="code" href="classTransaction.html#Transactionm1">itemlist</a>[itemIndex]] != -1) {
00326                 Trans[InvF1IndexList[newTransaction-&gt;<a class="code" href="classTransaction.html#Transactionm1">itemlist</a>[itemIndex]]]-&gt;FillEmptyPosition(transIndex);
00327             }
00328         }
00329 
00330         transIndex++;
00331         <span class="keyword">delete</span> newTransaction;
00332         newTransaction = inData2-&gt;<a class="code" href="group__InputOutput.html#a8">getNextTransaction</a>();
00333     }
00334 
00335     <span class="keyword">delete</span> newTransaction;
00336     <span class="keyword">delete</span> inData2;
00337     <span class="keyword">delete</span> [] itemlist;
00338 
00339     time(&amp;<a class="code" href="group__TimingVariables.html#a4">read_finish</a>);
00340     <a class="code" href="group__TimingVariables.html#a5">read_time</a> = difftime(<a class="code" href="group__TimingVariables.html#a4">read_finish</a>, <a class="code" href="group__TimingVariables.html#a3">read_start</a>);
00341     printf(<span class="stringliteral">"Reading input time:    %.2f seconds.\n"</span>, <a class="code" href="group__TimingVariables.html#a5">read_time</a>);
00342 
00343     <span class="comment">// Create F1</span>
00344     BitmapList::iterator bli = Trans.begin();
00345     itemIndex = 0;
00346 
00347     <span class="keywordflow">while</span> (bli != Trans.end()) {
00348         <a class="code" href="classTreeNode.html">TreeNode</a> *node = <span class="keyword">new</span> <a class="code" href="classTreeNode.html">TreeNode</a>(
00349                              NULL,
00350                              (*bli),
00351                              1,
00352                              -1,
00353                              F1IndexList[itemIndex],
00354                              -1,
00355                              0);
00356         <a class="code" href="group__InputOutput.html#a0">AddToF1</a>(node);
00357         bli++;
00358         itemIndex++;
00359     }
00360 
00361     <span class="keyword">delete</span> [] Counters;
00362     <span class="keyword">delete</span> [] F1IndexList;
00363     <span class="keyword">delete</span> [] InvF1IndexList;
00364 }
00365 <span class="comment"></span>
00366 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
00367 <span class="comment">/// To print the MFI data out to an ASCII file</span>
00368 <span class="comment">///     with each entry having the format:</span>
00369 <span class="comment">///     [list of items in MFI entry...] [(support)]</span>
00370 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
<a name="l00371"></a><a class="code" href="group__InputOutput.html#a3">00371</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="group__InputOutput.html#a3">PrintMFI</a>() {
00372     <span class="comment">// open output file</span>
00373     outFile = <span class="keyword">new</span> <a class="code" href="classItemsetOutput.html">ItemsetOutput</a>(<a class="code" href="group__CommandLineParameters.html#a1">outFilename</a>);
00374     <span class="keywordflow">if</span> (!outFile-&gt;<a class="code" href="group__InputOutput.html#a6">isOpen</a>()) {
00375         cerr &lt;&lt; <span class="stringliteral">"Output file not open!"</span> &lt;&lt; endl;
00376         exit(1);
00377     }
00378 
00379     <span class="keywordflow">if</span> (<a class="code" href="group__ProgramVariables.html#a4">FullF1size</a> != 0) {
00380         <span class="comment">// translate bitmap to list of INTs</span>
00381         <span class="keywordtype">int</span>* ITEMS = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="group__ProgramVariables.html#a4">FullF1size</a>];
00382         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="group__ProgramVariables.html#a1">MFISize</a>; i++) {
00383             <span class="keywordtype">int</span> j = 0;
00384             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc &lt; <a class="code" href="group__ProgramVariables.html#a4">FullF1size</a>; cc++) {
00385                 <span class="keywordflow">if</span> (<a class="code" href="group__DataVariables.html#a10">MFI</a>[i]-&gt;CheckPosition(cc, <a class="code" href="group__CounterVariables.html#a6">CountCheckPosition</a>) &gt; 0) {
00386                     ITEMS[j] = <a class="code" href="group__DataVariables.html#a8">ItemMap</a>[cc];
00387                     j++;
00388                 }
00389             }
00390 
00391             outFile-&gt;<a class="code" href="group__InputOutput.html#a7">printSet</a>(<a class="code" href="group__DataVariables.html#a10">MFI</a>[i]-&gt;_count, ITEMS, <a class="code" href="group__DataVariables.html#a12">SupportCountList</a>[i]);
00392         }
00393         <span class="keyword">delete</span> [] ITEMS;
00394     } <span class="keywordflow">else</span> {
00395         outFile-&gt;<a class="code" href="group__InputOutput.html#a7">printSet</a>(0, NULL, <a class="code" href="group__CommandLineParameters.html#a7">TransCount</a>);
00396     }
00397 
00398     <span class="keyword">delete</span> outFile;
00399 }
00400 <span class="comment"></span>
00401 <span class="comment">/** @} */</span>
00402 
00403 
00404 <span class="comment">/*********************************************************************</span>
00405 <span class="comment"> Algorithmic components</span>
00406 <span class="comment">*********************************************************************/</span><span class="comment"></span>
00407 <span class="comment">/// @defgroup AlgorithmicComponents Algorithmic Component Functions</span>
00408 <span class="comment">/// Algorithm components (HUTMFI, PEP, etc.)</span>
00409 <span class="comment"></span><span class="comment">/** @{ */</span>
00410 <span class="comment"></span>
00411 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
00412 <span class="comment">/// Check for an existing superset of name in the MFI</span>
00413 <span class="comment">///</span>
00414 <span class="comment">/// @param location          The node we're at.  Use this to examine only</span>
00415 <span class="comment">///                          the relevant portion of the MFI</span>
00416 <span class="comment">/// @return True - if superset found.</span>
00417 <span class="comment">///         False - if no superset.</span>
00418 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
<a name="l00419"></a><a class="code" href="group__AlgorithmicComponents.html#a0">00419</a> <span class="comment"></span><span class="keywordtype">bool</span> <a class="code" href="group__AlgorithmicComponents.html#a0">LMFISuperSet</a>(<a class="code" href="classTreeNode.html">TreeNode</a>* location) {
00420     <span class="keywordflow">return</span> (location-&gt;<a class="code" href="classTreeNode.html#TreeNodem7">rEnd</a> &gt; location-&gt;<a class="code" href="classTreeNode.html#TreeNodem6">rBegin</a>);
00421 }
00422 <span class="comment"></span>
00423 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
00424 <span class="comment">/// Output itemset (don't need to save bitmaps for FI)</span>
00425 <span class="comment">///</span>
00426 <span class="comment">/// @param C                 the current node</span>
00427 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
<a name="l00428"></a><a class="code" href="group__AlgorithmicComponents.html#a1">00428</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="group__AlgorithmicComponents.html#a1">AddToFI</a>(<a class="code" href="classTreeNode.html">TreeNode</a> *C) {
00429     <span class="keywordtype">int</span> itemsetIndex = 0;
00430     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc &lt; <a class="code" href="group__ProgramVariables.html#a4">FullF1size</a>; cc++) {
00431         <span class="keywordflow">if</span> (C-&gt;<a class="code" href="classTreeNode.html#TreeNodem0">Name</a>-&gt;<a class="code" href="classBaseBitmap.html#Bitmapa17">CheckPosition</a>(cc, <a class="code" href="group__CounterVariables.html#a6">CountCheckPosition</a>) &gt; 0) {
00432             <a class="code" href="group__DataVariables.html#a16">ItemsetBuffy</a>[itemsetIndex] = <a class="code" href="group__DataVariables.html#a8">ItemMap</a>[cc];
00433             itemsetIndex++;
00434         }
00435     }
00436 
00437     <a class="code" href="group__DataVariables.html#a15">MFIBySizes</a>[C-&gt;<a class="code" href="classTreeNode.html#TreeNodem0">Name</a>-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a>]++;
00438     <span class="keywordflow">if</span> (C-&gt;<a class="code" href="classTreeNode.html#TreeNodem0">Name</a>-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a> &gt; <a class="code" href="group__ProgramVariables.html#a10">maxItemsetSize</a>)
00439         <a class="code" href="group__ProgramVariables.html#a10">maxItemsetSize</a> = C-&gt;<a class="code" href="classTreeNode.html#TreeNodem0">Name</a>-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a>;
00440 
00441     <span class="keywordflow">if</span> (outputMFI)
00442         outFile-&gt;<a class="code" href="group__InputOutput.html#a7">printSet</a>(C-&gt;<a class="code" href="classTreeNode.html#TreeNodem0">Name</a>-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a>, <a class="code" href="group__DataVariables.html#a16">ItemsetBuffy</a>, C-&gt;<a class="code" href="classTreeNode.html#TreeNodem1">Trans</a>-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a>);
00443 
00444     <span class="comment">// Update stat variables</span>
00445     <a class="code" href="group__ProgramVariables.html#a2">MFIDepth</a> += C-&gt;<a class="code" href="classTreeNode.html#TreeNodem0">Name</a>-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a>;
00446     <a class="code" href="group__ProgramVariables.html#a1">MFISize</a>++;
00447 }
00448 <span class="comment"></span>
00449 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
00450 <span class="comment">/// Add this node's name bitmap to the MFI list</span>
00451 <span class="comment">///</span>
00452 <span class="comment">/// @param C                 the current node</span>
00453 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
<a name="l00454"></a><a class="code" href="group__AlgorithmicComponents.html#a2">00454</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="group__AlgorithmicComponents.html#a2">AddToMFI</a>(<a class="code" href="classTreeNode.html">TreeNode</a> *C) {
00455     <span class="comment">// copy name bitmap</span>
00456     <a class="code" href="classBaseBitmap.html">BaseBitmap</a> *name = <span class="keyword">new</span> <a class="code" href="classBaseBitmap.html">BaseBitmap</a>(*C-&gt;<a class="code" href="classTreeNode.html#TreeNodem0">Name</a>);
00457 
00458     <span class="comment">// add to MFI</span>
00459     <a class="code" href="group__DataVariables.html#a10">MFI</a>.push_back(name);
00460 
00461     <span class="comment">// update the end of the relevant</span>
00462     C-&gt;<a class="code" href="classTreeNode.html#TreeNodem7">rEnd</a>++;
00463 
00464     <span class="comment">// Update stat variables</span>
00465     <a class="code" href="group__ProgramVariables.html#a2">MFIDepth</a> += C-&gt;<a class="code" href="classTreeNode.html#TreeNodem0">Name</a>-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a>;
00466     <a class="code" href="group__ProgramVariables.html#a1">MFISize</a>++;
00467 
00468     <a class="code" href="group__DataVariables.html#a12">SupportCountList</a>.push_back(C-&gt;<a class="code" href="classTreeNode.html#TreeNodem1">Trans</a>-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a>);
00469     <a class="code" href="group__DataVariables.html#a15">MFIBySizes</a>[name-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a>]++;
00470     <span class="keywordflow">if</span> (name-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a> &gt; <a class="code" href="group__ProgramVariables.html#a10">maxItemsetSize</a>)
00471         <a class="code" href="group__ProgramVariables.html#a10">maxItemsetSize</a> = name-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a>;
00472 }
00473 <span class="comment"></span>
00474 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
00475 <span class="comment">/// Add this node's name bitmap to the FCI list</span>
00476 <span class="comment">///</span>
00477 <span class="comment">/// @param C                 the current node</span>
00478 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
<a name="l00479"></a><a class="code" href="group__AlgorithmicComponents.html#a3">00479</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="group__AlgorithmicComponents.html#a3">AddToFCI</a>(<a class="code" href="classTreeNode.html">TreeNode</a> *C) {
00480     <span class="comment">// Search HT</span>
00481     HashTable::iterator h = <a class="code" href="group__DataVariables.html#a11">HT</a>.find(C-&gt;<a class="code" href="classTreeNode.html#TreeNodem1">Trans</a>-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a>);
00482 
00483     <span class="comment">// If the support of node C is NOT in HashSup</span>
00484     <span class="keywordflow">if</span> (h == <a class="code" href="group__DataVariables.html#a11">HT</a>.end()) {
00485         <span class="comment">// Add a new list to the HashSup</span>
00486         <a class="code" href="group__GlobalVariables.html#a4">ItemSet</a>* newList = <span class="keyword">new</span> <a class="code" href="group__GlobalVariables.html#a4">ItemSet</a>();
00487         newList-&gt;reserve(500);
00488         newList-&gt;push_back(<a class="code" href="group__DataVariables.html#a10">MFI</a>.size());
00489         <a class="code" href="group__DataVariables.html#a11">HT</a>.insert(HashTable::value_type(C-&gt;<a class="code" href="classTreeNode.html#TreeNodem1">Trans</a>-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a>, newList));
00490 
00491         <span class="comment">// Else add pointer to last item in iName to HT entry</span>
00492     } <span class="keywordflow">else</span> {
00493         <span class="keywordflow">for</span> (ItemSet::reverse_iterator goli = (*h).second-&gt;rbegin();
00494                 goli != (*h).second-&gt;rend();
00495                 goli++)
00496             <span class="keywordflow">if</span> (<a class="code" href="group__DataVariables.html#a10">MFI</a>[*goli]-&gt;Superset(C-&gt;<a class="code" href="classTreeNode.html#TreeNodem0">Name</a>))
00497                 <span class="keywordflow">return</span> ;
00498 
00499         <span class="comment">// search the table</span>
00500         (*h).second-&gt;push_back(<a class="code" href="group__DataVariables.html#a10">MFI</a>.size());
00501     }
00502 
00503     <span class="comment">// copy name bitmap</span>
00504     <a class="code" href="classBaseBitmap.html">BaseBitmap</a> *name = <span class="keyword">new</span> <a class="code" href="classBaseBitmap.html">BaseBitmap</a>(*C-&gt;<a class="code" href="classTreeNode.html#TreeNodem0">Name</a>);
00505 
00506     <span class="comment">// add to MFI</span>
00507     <a class="code" href="group__DataVariables.html#a10">MFI</a>.push_back(name);
00508 
00509     <span class="comment">// Update stat variables</span>
00510     <a class="code" href="group__ProgramVariables.html#a2">MFIDepth</a> += C-&gt;<a class="code" href="classTreeNode.html#TreeNodem0">Name</a>-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a>;
00511     <a class="code" href="group__ProgramVariables.html#a1">MFISize</a>++;
00512 
00513     <a class="code" href="group__DataVariables.html#a12">SupportCountList</a>.push_back(C-&gt;<a class="code" href="classTreeNode.html#TreeNodem1">Trans</a>-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a>);
00514     <a class="code" href="group__DataVariables.html#a15">MFIBySizes</a>[name-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a>]++;
00515     <span class="keywordflow">if</span> (name-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a> &gt; <a class="code" href="group__ProgramVariables.html#a10">maxItemsetSize</a>)
00516         <a class="code" href="group__ProgramVariables.html#a10">maxItemsetSize</a> = name-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a>;
00517 }
00518 
<a name="l00519"></a><a class="code" href="group__AlgorithmicComponents.html#a4">00519</a> <span class="keywordtype">int</span> <a class="code" href="group__AlgorithmicComponents.html#a4">SortLMFI</a>(<span class="keywordtype">int</span> rBegin, <span class="keywordtype">int</span> rEnd, <span class="keywordtype">int</span> sortBy) {
00520     <span class="keywordtype">int</span> left = rBegin;
00521     <span class="keywordtype">int</span> right = rEnd - 1;
00522     <span class="keywordflow">while</span> (left &lt;= right) {
00523         <span class="keywordflow">while</span> (left &lt; rEnd &amp;&amp; !<a class="code" href="group__DataVariables.html#a10">MFI</a>[left]-&gt;CheckPosition(sortBy, <a class="code" href="group__CounterVariables.html#a6">CountCheckPosition</a>))
00524             left++;
00525         <span class="keywordflow">while</span> (right &gt;= rBegin &amp;&amp; <a class="code" href="group__DataVariables.html#a10">MFI</a>[right]-&gt;CheckPosition(sortBy, <a class="code" href="group__CounterVariables.html#a6">CountCheckPosition</a>))
00526             right--;
00527         <span class="keywordflow">if</span> (left &lt; right) {
00528             <span class="comment">// we are now at a point where MFI[left] is relevant</span>
00529             <span class="comment">// and MFI[right] is not since left &lt; right, we swap the two</span>
00530             <a class="code" href="classBaseBitmap.html">BaseBitmap</a>* tempBitmap = <a class="code" href="group__DataVariables.html#a10">MFI</a>[left];
00531             MFI[left] = MFI[right];
00532             MFI[right] = tempBitmap;
00533             tempBitmap = NULL;
00534             left++;
00535             right--;
00536         }
00537     }
00538 
00539     <span class="comment">// the first relevant one for the next node is left</span>
00540     <span class="keywordflow">return</span> left;
00541 }
00542 <span class="comment"></span>
00543 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
00544 <span class="comment">/// Determine whether a HUTMFI is true.</span>
00545 <span class="comment">///     - if HUT is in MFI, then HUT is frequent</span>
00546 <span class="comment">///     and the subtree rooted at this node can be pruned</span>
00547 <span class="comment">///</span>
00548 <span class="comment">/// @return True if HUT is in the MFI</span>
00549 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
<a name="l00550"></a><a class="code" href="group__AlgorithmicComponents.html#a5">00550</a> <span class="comment"></span><span class="keywordtype">bool</span> <a class="code" href="group__AlgorithmicComponents.html#a5">CheckHUTMFI</a>(<a class="code" href="classTreeNode.html">TreeNode</a> *C, <span class="keywordtype">int</span> iTAIL) {
00551 
00552     <span class="comment">// for each element i in the tail form {head} U {i} and check for a</span>
00553     <span class="comment">//     superset in the MFI</span>
00554     <span class="keywordtype">int</span> rBegin = C-&gt;<a class="code" href="classTreeNode.html#TreeNodem6">rBegin</a>;
00555     <span class="keywordtype">int</span> rEnd = C-&gt;<a class="code" href="classTreeNode.html#TreeNodem7">rEnd</a>;
00556     <span class="keywordflow">for</span> (; iTAIL &lt; C-&gt;<a class="code" href="classTreeNode.html#TreeNodem5">tEnd</a>; iTAIL++) {
00557         rBegin = <a class="code" href="group__AlgorithmicComponents.html#a4">SortLMFI</a>(rBegin, rEnd, <a class="code" href="group__DataVariables.html#a0">F1</a>[gTail[iTAIL].Item]-&gt;Prefix);
00558 
00559         <span class="keywordflow">if</span> (rEnd &lt;= rBegin)
00560             <span class="keywordflow">return</span> <span class="keyword">false</span>;
00561     }
00562 
00563     <span class="keywordflow">return</span> <span class="keyword">true</span>;
00564 }
00565 <span class="comment"></span>
00566 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
00567 <span class="comment">/// Dynamically reorder the elements in the tail by increasing support</span>
00568 <span class="comment">///    - Expand all children and sort by increasing support</span>
00569 <span class="comment">///    - Remove infrequent children</span>
00570 <span class="comment">///</span>
00571 <span class="comment">/// @param C                 current node</span>
00572 <span class="comment">/// @param iTAIL             index into tail of current node</span>
00573 <span class="comment">/// @param useComp           whether compressed bitmaps should be used</span>
00574 <span class="comment">/// @param NoChild           whether C has any frequent children</span>
00575 <span class="comment">/// @param AllFreq           whether all children are frequent</span>
00576 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
<a name="l00577"></a><a class="code" href="group__AlgorithmicComponents.html#a6">00577</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="group__AlgorithmicComponents.html#a6">ReorderTail</a>(
00578     <a class="code" href="classTreeNode.html">TreeNode</a> *C,
00579     <span class="keywordtype">int</span> &amp;iTAIL,
00580     <span class="keywordtype">bool</span> useComp,
00581     <span class="keywordtype">bool</span> &amp;NoChild,
00582     <span class="keywordtype">bool</span> &amp;AllFreq) {
00583 
00584     <span class="keywordtype">int</span> tailIndex = 0;
00585     <span class="keywordtype">int</span> lol = 0;
00586     <span class="comment">// for each tail element</span>
00587     <span class="keywordflow">for</span> (lol = iTAIL; lol &lt; C-&gt;<a class="code" href="classTreeNode.html#TreeNodem5">tEnd</a>; lol++) {
00588         <a class="code" href="classBitmap.html">Bitmap</a> *trans = <a class="code" href="group__DataVariables.html#a1">TransBuffy</a>[C-&gt;<a class="code" href="classTreeNode.html#TreeNodem2">Depth</a>];
00589         <span class="keywordtype">int</span> theCount = 0;
00590 
00591         <span class="comment">// Compress the bitmaps</span>
00592         <span class="keywordflow">if</span> (useComp &amp;&amp; (<a class="code" href="group__DataVariables.html#a0">F1</a>[gTail[lol].<a class="code" href="classTailElement.html#TailElementm1">Item</a>]-&gt;compID != C-&gt;<a class="code" href="classTreeNode.html#TreeNodem3">compID</a>)) {
00593             <a class="code" href="group__DataVariables.html#a0">F1</a>[gTail[lol].<a class="code" href="classTailElement.html#TailElementm1">Item</a>]-&gt;Trans-&gt;BuildRelComp(
00594                 *TransBuffy[<a class="code" href="group__ProgramVariables.html#a7">projectDepth</a>]);
00595             <a class="code" href="group__DataVariables.html#a0">F1</a>[gTail[lol].<a class="code" href="classTailElement.html#TailElementm1">Item</a>]-&gt;compID = C-&gt;<a class="code" href="classTreeNode.html#TreeNodem3">compID</a>;
00596             <a class="code" href="group__CounterVariables.html#a9">CountRebuilds</a>++;
00597         }
00598 
00599         <span class="comment">// Use the compressed bitmaps</span>
00600         <span class="keywordflow">if</span> (useComp) {
00601             <span class="comment">// AND the compressed bitmaps and count the result</span>
00602             trans-&gt;<a class="code" href="group__BitmapProcessing.html#a16">AndCompOnly</a>(
00603                 *C-&gt;<a class="code" href="classTreeNode.html#TreeNodem1">Trans</a>,
00604                 *<a class="code" href="group__DataVariables.html#a0">F1</a>[gTail[lol].<a class="code" href="classTailElement.html#TailElementm1">Item</a>]-&gt;Trans,
00605                 <a class="code" href="group__CounterVariables.html#a4">CountSmallAnds</a>);
00606             theCount = trans-&gt;<a class="code" href="group__BitmapProcessing.html#a15">SmallCount</a>(<a class="code" href="group__CounterVariables.html#a2">CountCounts</a>);
00607 
00608             <span class="comment">// use the full bitmaps</span>
00609         } <span class="keywordflow">else</span> {
00610             <span class="comment">// AND &amp; count the bitmaps</span>
00611             trans-&gt;<a class="code" href="group__BitmapProcessing.html#a7">AndOnly</a>(*C-&gt;<a class="code" href="classTreeNode.html#TreeNodem1">Trans</a>, *<a class="code" href="group__DataVariables.html#a0">F1</a>[gTail[lol].<a class="code" href="classTailElement.html#TailElementm1">Item</a>]-&gt;Trans, <a class="code" href="group__CounterVariables.html#a3">CountAnds</a>);
00612             theCount = trans-&gt;<a class="code" href="classBitmap.html#Bitmapl0">Count</a>(<a class="code" href="group__CounterVariables.html#a2">CountCounts</a>);
00613         }
00614 
00615         <span class="comment">// If the results is frequent</span>
00616         <span class="keywordflow">if</span> (theCount &gt;= <a class="code" href="group__CommandLineParameters.html#a9">MS</a>) {
00617             <span class="comment">// if PEP pruning holds</span>
00618             <span class="keywordflow">if</span> (<a class="code" href="group__CommandLineParameters.html#a14">PEPrune</a> &amp;&amp; (trans-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a> == C-&gt;<a class="code" href="classTreeNode.html#TreeNodem1">Trans</a>-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a>)) {
00619                 <span class="comment">// Move tail element from tail to head</span>
00620                 C-&gt;<a class="code" href="classTreeNode.html#TreeNodem0">Name</a>-&gt;<a class="code" href="group__BitmapProcessing.html#a6">Or</a>(*C-&gt;<a class="code" href="classTreeNode.html#TreeNodem0">Name</a>, *<a class="code" href="group__DataVariables.html#a0">F1</a>[gTail[lol].<a class="code" href="classTailElement.html#TailElementm1">Item</a>]-&gt;Name);
00621                 <a class="code" href="group__CounterVariables.html#a5">CountPEPrunes</a>++;
00622 
00623                 <span class="comment">// add tail element to reordered tail</span>
00624             } <span class="keywordflow">else</span> {
00625                 NoChild = <span class="keyword">false</span>;
00626 
00627                 <span class="comment">// create new tail element</span>
00628                 TailBuffy[tailIndex].<a class="code" href="classTailElement.html#TailElementm0">Count</a> = theCount;
00629                 TailBuffy[tailIndex].<a class="code" href="classTailElement.html#TailElementm1">Item</a> = gTail[lol].<a class="code" href="classTailElement.html#TailElementm1">Item</a>;
00630                 tailIndex++;
00631             }
00632         } <span class="keywordflow">else</span>
00633             AllFreq = <span class="keyword">false</span>;
00634     }
00635 
00636     sort(TailBuffy, TailBuffy + tailIndex);
00637 
00638     <span class="comment">// Set the begin and end values of the new tail</span>
00639     iTAIL = C-&gt;<a class="code" href="classTreeNode.html#TreeNodem5">tEnd</a>;
00640     C-&gt;<a class="code" href="classTreeNode.html#TreeNodem5">tEnd</a> = iTAIL + tailIndex;
00641     C-&gt;<a class="code" href="classTreeNode.html#TreeNodem4">tBegin</a> = iTAIL;
00642     <span class="keywordtype">int</span> r = 0;
00643 
00644     <span class="comment">// Copy new tail into next slots</span>
00645     <span class="keywordflow">for</span> (lol = iTAIL; lol &lt; C-&gt;<a class="code" href="classTreeNode.html#TreeNodem5">tEnd</a>; lol++) {
00646         gTail[lol] = TailBuffy[r];
00647         r++;
00648     }
00649 }
00650 <span class="comment"></span>
00651 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
00652 <span class="comment">/// Simply copy over the tail without expanding any of the children</span>
00653 <span class="comment">///    for pure DFS (no expansion of all children)</span>
00654 <span class="comment">///</span>
00655 <span class="comment">/// @param C                 current node</span>
00656 <span class="comment">/// @param iTAIL             index into tail of current node</span>
00657 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
<a name="l00658"></a><a class="code" href="group__AlgorithmicComponents.html#a7">00658</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="group__AlgorithmicComponents.html#a7">NoorderTail</a>(
00659     <a class="code" href="classTreeNode.html">TreeNode</a> *C,
00660     <span class="keywordtype">int</span> &amp;iTAIL) {
00661 
00662     <span class="comment">// set begin and end tail pointers</span>
00663     iTAIL = C-&gt;<a class="code" href="classTreeNode.html#TreeNodem5">tEnd</a>;
00664     C-&gt;<a class="code" href="classTreeNode.html#TreeNodem5">tEnd</a> = C-&gt;<a class="code" href="classTreeNode.html#TreeNodem5">tEnd</a> - C-&gt;<a class="code" href="classTreeNode.html#TreeNodem4">tBegin</a> + C-&gt;<a class="code" href="classTreeNode.html#TreeNodem5">tEnd</a>;
00665     C-&gt;<a class="code" href="classTreeNode.html#TreeNodem4">tBegin</a> = iTAIL;
00666     <span class="keywordtype">int</span> r = 0;
00667 
00668     <span class="comment">// copy over old tail to new tail</span>
00669     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lol = iTAIL; lol &lt; C-&gt;<a class="code" href="classTreeNode.html#TreeNodem5">tEnd</a>; lol++) {
00670         gTail[lol] = gTail[lol - C-&gt;<a class="code" href="classTreeNode.html#TreeNodem5">tEnd</a> + C-&gt;<a class="code" href="classTreeNode.html#TreeNodem4">tBegin</a>];
00671         r++;
00672     }
00673 }
00674 
00675 <span class="comment"></span>
00676 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
00677 <span class="comment">/// The main MAFIA algorithm function</span>
00678 <span class="comment">///</span>
00679 <span class="comment">/// @param C                 the current node</span>
00680 <span class="comment">/// @param HUT               whether this is a HUT check (left most branch)</span>
00681 <span class="comment">/// @param FHUT              [output] whether the HUT is frequent</span>
00682 <span class="comment">/// @param useComp           if compression has been switched on</span>
00683 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
<a name="l00684"></a><a class="code" href="group__AlgorithmicComponents.html#a8">00684</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="group__AlgorithmicComponents.html#a8">MAFIA</a>(<a class="code" href="classTreeNode.html">TreeNode</a> *C, <span class="keywordtype">bool</span> HUT, <span class="keywordtype">bool</span> &amp;FHUT, <span class="keywordtype">bool</span> useComp) {
00685     <a class="code" href="group__CounterVariables.html#a1">CountNodes</a>++;
00686     <span class="keywordtype">int</span> iTAIL = C-&gt;<a class="code" href="classTreeNode.html#TreeNodem4">tBegin</a>;   <span class="comment">// index into the tail</span>
00687     <span class="keywordtype">bool</span> NoChild = <span class="keyword">true</span>;     <span class="comment">// whether the node has any frequent children</span>
00688     <span class="keywordtype">bool</span> AllFreq = <span class="keyword">true</span>;     <span class="comment">// whether all the children are frequent</span>
00689     FHUT = <span class="keyword">false</span>;            <span class="comment">// whether this is a FHUT</span>
00690     <span class="keywordtype">int</span> beforeCountNodes = <a class="code" href="group__CounterVariables.html#a1">CountNodes</a>;
00691     <span class="keywordtype">int</span> frequentTailSize = C-&gt;<a class="code" href="classTreeNode.html#TreeNodem5">tEnd</a> - iTAIL;
00692 
00693     <span class="keywordflow">if</span> (iTAIL &lt; C-&gt;<a class="code" href="classTreeNode.html#TreeNodem5">tEnd</a>) {
00694 
00695         <span class="keywordflow">if</span> (C != Root) {
00696             <span class="keywordflow">if</span> (Reorder) {
00697                 <a class="code" href="group__AlgorithmicComponents.html#a6">ReorderTail</a>(C, iTAIL, useComp, NoChild, AllFreq);
00698             } <span class="keywordflow">else</span> {
00699                 <a class="code" href="group__AlgorithmicComponents.html#a7">NoorderTail</a>(C, iTAIL);
00700             }
00701         }
00702 
00703         frequentTailSize = C-&gt;<a class="code" href="classTreeNode.html#TreeNodem5">tEnd</a> - iTAIL;
00704 
00705         <span class="keywordtype">int</span> estimateTail = (int)(frequentTailSize / (double)<a class="code" href="group__ProgramVariables.html#a9">EstimateDiv</a>);
00706         <span class="keywordflow">if</span> (estimateTail &gt; 0 &amp;&amp; C-&gt;<a class="code" href="classTreeNode.html#TreeNodem1">Trans</a>-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a> != <a class="code" href="group__CommandLineParameters.html#a7">TransCount</a>) {
00707             <span class="keywordtype">double</span> estimateSubTree = EstimateBuffy[estimateTail].<a class="code" href="classSubtreeEstimate.html#SubtreeEstimatem1">Sum</a> / (double)EstimateBuffy[estimateTail].<a class="code" href="classSubtreeEstimate.html#SubtreeEstimatem0">Count</a>;
00708             <span class="keywordtype">double</span> support = C-&gt;<a class="code" href="classTreeNode.html#TreeNodem1">Trans</a>-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a> / (double) <a class="code" href="group__CommandLineParameters.html#a7">TransCount</a>;
00709             <span class="keywordtype">double</span> factor = 11.597 - 29.914 * (support - .52392) * (support - .52392);
00710             <span class="keywordtype">double</span> cost = abs(factor * frequentTailSize / (1 - 1.2 * support));
00711             <span class="comment">//double cost = 5 * frequentTailSize / (1 - support);</span>
00712 
00713             <span class="comment">// check if relative comp should be performed</span>
00714             <span class="keywordflow">if</span> ((!useComp) &amp;&amp; (estimateSubTree &gt; cost)) {
00715 
00716                 <span class="comment">// build the relative bitmap for source [node bitmap] (all 1's)</span>
00717                 C-&gt;<a class="code" href="classTreeNode.html#TreeNodem1">Trans</a>-&gt;<a class="code" href="group__BitmapProcessing.html#a19">BuildSource</a>();
00718 
00719                 <span class="comment">// remember the depth of the FULL bitmap your projecting from</span>
00720                 <a class="code" href="group__ProgramVariables.html#a7">projectDepth</a> = C-&gt;<a class="code" href="classTreeNode.html#TreeNodem2">Depth</a> - 1;
00721 
00722                 <span class="comment">// increment the ID</span>
00723                 C-&gt;<a class="code" href="classTreeNode.html#TreeNodem3">compID</a> = <a class="code" href="group__ProgramVariables.html#a6">MAX_compID</a>;
00724                 <a class="code" href="group__ProgramVariables.html#a6">MAX_compID</a>++;
00725                 useComp = <span class="keyword">true</span>;
00726             }
00727         }
00728 
00729         <span class="comment">// Candidate generation - extend the Head with the tail elements</span>
00730         <span class="comment">// We start from the end of the tail and move backwards</span>
00731         <span class="comment">// Therefore the tail is iterated through in increasing support,</span>
00732         <span class="comment">// but is stored in decreasing support.</span>
00733         <span class="keywordflow">while</span> (iTAIL &lt; C-&gt;<a class="code" href="classTreeNode.html#TreeNodem5">tEnd</a>) {
00734             <span class="comment">// form a one-extension</span>
00735             <a class="code" href="classBitmap.html">Bitmap</a> *trans = <a class="code" href="group__DataVariables.html#a1">TransBuffy</a>[C-&gt;<a class="code" href="classTreeNode.html#TreeNodem2">Depth</a>];
00736             <a class="code" href="classBaseBitmap.html">BaseBitmap</a> *name = <a class="code" href="group__DataVariables.html#a2">NameBuffy</a>[C-&gt;<a class="code" href="classTreeNode.html#TreeNodem2">Depth</a>];
00737             <a class="code" href="classTreeNode.html">TreeNode</a> *newNode = <a class="code" href="group__DataVariables.html#a3">NodeBuffy</a>[C-&gt;<a class="code" href="classTreeNode.html#TreeNodem2">Depth</a>];
00738 
00739             <span class="comment">// create name for the new node</span>
00740             name-&gt;<a class="code" href="group__BitmapProcessing.html#a6">Or</a>(*C-&gt;<a class="code" href="classTreeNode.html#TreeNodem0">Name</a>, *<a class="code" href="group__DataVariables.html#a0">F1</a>[gTail[iTAIL].<a class="code" href="classTailElement.html#TailElementm1">Item</a>]-&gt;Name);
00741 
00742             <span class="comment">// compress the bitmaps if warranted</span>
00743             <span class="keywordflow">if</span> (useComp &amp;&amp; (<a class="code" href="group__DataVariables.html#a0">F1</a>[gTail[iTAIL].<a class="code" href="classTailElement.html#TailElementm1">Item</a>]-&gt;compID != C-&gt;<a class="code" href="classTreeNode.html#TreeNodem3">compID</a>)) {
00744                 <span class="comment">// build the relative for this node</span>
00745                 <a class="code" href="group__DataVariables.html#a0">F1</a>[gTail[iTAIL].<a class="code" href="classTailElement.html#TailElementm1">Item</a>]-&gt;Trans-&gt;BuildRelComp(
00746                     *TransBuffy[<a class="code" href="group__ProgramVariables.html#a7">projectDepth</a>]);
00747                 <a class="code" href="group__DataVariables.html#a0">F1</a>[gTail[iTAIL].<a class="code" href="classTailElement.html#TailElementm1">Item</a>]-&gt;compID = C-&gt;<a class="code" href="classTreeNode.html#TreeNodem3">compID</a>;
00748                 <a class="code" href="group__CounterVariables.html#a9">CountRebuilds</a>++;
00749             }
00750 
00751             <span class="keywordtype">int</span> theCount = 0;
00752 
00753             <span class="comment">// use the compressed bitmaps for ANDing and counting</span>
00754             <span class="keywordflow">if</span> (useComp) {
00755                 <span class="comment">// AND and count small bitmaps</span>
00756                 trans-&gt;<a class="code" href="group__BitmapProcessing.html#a16">AndCompOnly</a>(
00757                     *C-&gt;<a class="code" href="classTreeNode.html#TreeNodem1">Trans</a>,
00758                     *<a class="code" href="group__DataVariables.html#a0">F1</a>[gTail[iTAIL].<a class="code" href="classTailElement.html#TailElementm1">Item</a>]-&gt;Trans,
00759                     <a class="code" href="group__CounterVariables.html#a4">CountSmallAnds</a>);
00760 
00761                 <span class="keywordflow">if</span> (Reorder)
00762                     trans-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a> = gTail[iTAIL].<a class="code" href="classTailElement.html#TailElementm0">Count</a>;
00763                 <span class="keywordflow">else</span>
00764                     theCount = trans-&gt;<a class="code" href="group__BitmapProcessing.html#a15">SmallCount</a>(<a class="code" href="group__CounterVariables.html#a2">CountCounts</a>);
00765             } <span class="keywordflow">else</span> {
00766                 <span class="comment">// AND and count the full bitmaps</span>
00767                 trans-&gt;<a class="code" href="group__BitmapProcessing.html#a7">AndOnly</a>(
00768                     *C-&gt;<a class="code" href="classTreeNode.html#TreeNodem1">Trans</a>,
00769                     *<a class="code" href="group__DataVariables.html#a0">F1</a>[gTail[iTAIL].<a class="code" href="classTailElement.html#TailElementm1">Item</a>]-&gt;Trans,
00770                     <a class="code" href="group__CounterVariables.html#a3">CountAnds</a>);
00771 
00772                 <span class="keywordflow">if</span> (Reorder)
00773                     trans-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a> = gTail[iTAIL].<a class="code" href="classTailElement.html#TailElementm0">Count</a>;
00774                 <span class="keywordflow">else</span>
00775                     theCount = trans-&gt;<a class="code" href="classBitmap.html#Bitmapl0">Count</a>(<a class="code" href="group__CounterVariables.html#a2">CountCounts</a>);
00776             }
00777             <span class="keywordflow">if</span> (!<a class="code" href="group__CommandLineParameters.html#a15">Reorder</a> &amp;&amp; <a class="code" href="group__CommandLineParameters.html#a14">PEPrune</a> &amp;&amp; (theCount == C-&gt;<a class="code" href="classTreeNode.html#TreeNodem1">Trans</a>-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a>)) {
00778                 <a class="code" href="group__CounterVariables.html#a5">CountPEPrunes</a>++;
00779                 C-&gt;<a class="code" href="classTreeNode.html#TreeNodem0">Name</a>-&gt;<a class="code" href="group__BitmapProcessing.html#a6">Or</a>(*C-&gt;<a class="code" href="classTreeNode.html#TreeNodem0">Name</a>, *<a class="code" href="group__DataVariables.html#a0">F1</a>[gTail[iTAIL].<a class="code" href="classTailElement.html#TailElementm1">Item</a>]-&gt;Name);
00780                 iTAIL++;
00781                 <span class="keywordflow">continue</span>;
00782             }
00783 
00784             <span class="comment">// Determine whether this candidate will be a HUT</span>
00785             <span class="comment">// Conceptually the leftmost branch of the tree is a HUT check</span>
00786             <span class="keywordflow">if</span> ((iTAIL != C-&gt;<a class="code" href="classTreeNode.html#TreeNodem4">tBegin</a>) &amp;&amp; (C != Root))
00787                 HUT = 0;
00788             <span class="keywordflow">else</span>
00789                 HUT = 1;
00790 
00791             <span class="keywordflow">if</span> (!AllFreq)
00792                 HUT = 0;
00793 
00794             <span class="keywordflow">if</span> (<a class="code" href="group__CommandLineParameters.html#a15">Reorder</a> || (theCount &gt;= <a class="code" href="group__CommandLineParameters.html#a9">MS</a>)) {
00795                 <span class="comment">// form the 1-extension node</span>
00796                 newNode-&gt;<a class="code" href="classTreeNode.html#TreeNodea2">setTreeNode</a>(name,
00797                                      trans,
00798                                      C-&gt;<a class="code" href="classTreeNode.html#TreeNodem2">Depth</a> + 1,
00799                                      C-&gt;<a class="code" href="classTreeNode.html#TreeNodem3">compID</a>,
00800                                      <a class="code" href="group__DataVariables.html#a0">F1</a>[gTail[iTAIL].<a class="code" href="classTailElement.html#TailElementm1">Item</a>]-&gt;Prefix,
00801                                      iTAIL + 1,
00802                                      C-&gt;<a class="code" href="classTreeNode.html#TreeNodem5">tEnd</a>);
00803 
00804                 <span class="comment">// setup the LMFI for the next level; it contains all</span>
00805                 <span class="comment">// itemsets in LMFI for this level that also include the</span>
00806                 <span class="comment">// one we're extending the node with.  We do sort of a</span>
00807                 <span class="comment">// quicksort thing to move the relevant itemsets for the</span>
00808                 <span class="comment">// next node to the end of the portion of the MFI relevant</span>
00809                 <span class="comment">// to this node</span>
00810 
00811                 newNode-&gt;<a class="code" href="classTreeNode.html#TreeNodem7">rEnd</a> = C-&gt;<a class="code" href="classTreeNode.html#TreeNodem7">rEnd</a>;
00812                 newNode-&gt;<a class="code" href="classTreeNode.html#TreeNodem6">rBegin</a> = <a class="code" href="group__AlgorithmicComponents.html#a4">SortLMFI</a>(C-&gt;<a class="code" href="classTreeNode.html#TreeNodem6">rBegin</a>, C-&gt;<a class="code" href="classTreeNode.html#TreeNodem7">rEnd</a>, newNode-&gt;<a class="code" href="classTreeNode.html#TreeNodem8">Prefix</a>);
00813 
00814                 <span class="comment">// Check for HUT in MFI for remaining tail</span>
00815                 <span class="keywordflow">if</span> (<a class="code" href="group__CommandLineParameters.html#a13">HUTMFI</a> &amp;&amp; newNode-&gt;<a class="code" href="classTreeNode.html#TreeNodem4">tBegin</a> != newNode-&gt;<a class="code" href="classTreeNode.html#TreeNodem5">tEnd</a> &amp;&amp; !HUT) {
00816                     <a class="code" href="group__CounterVariables.html#a7">CountHUTMFI</a>++;
00817 
00818                     <span class="keywordflow">if</span> (<a class="code" href="group__AlgorithmicComponents.html#a5">CheckHUTMFI</a>(newNode, newNode-&gt;<a class="code" href="classTreeNode.html#TreeNodem4">tBegin</a>)) {
00819                         <span class="comment">// stop generation of extensions</span>
00820                         <a class="code" href="group__CounterVariables.html#a8">CountHUTMFISuccess</a>++;
00821                         AllFreq = <span class="keyword">false</span>;
00822                         <span class="keywordflow">break</span>;
00823                     }
00824                 }
00825 
00826                 NoChild = <span class="keyword">false</span>;
00827 
00828                 <span class="comment">// recurse down the tree</span>
00829                 <a class="code" href="group__AlgorithmicComponents.html#a8">MAFIA</a>(newNode, HUT, FHUT, useComp);
00830 
00831                 <span class="comment">// Add those discovered from lower levels to the current LMFI</span>
00832                 <span class="comment">// LMFI_l = LMFI_l \union LMFI_{l+1}</span>
00833                 <span class="comment">// all we need to do is to update the end pointer</span>
00834                 C-&gt;<a class="code" href="classTreeNode.html#TreeNodem7">rEnd</a> = newNode-&gt;<a class="code" href="classTreeNode.html#TreeNodem7">rEnd</a>;
00835             } <span class="keywordflow">else</span>
00836                 AllFreq = <span class="keyword">false</span>;
00837 
00838             <span class="comment">// if this was a successful HUT check</span>
00839             <span class="keywordflow">if</span> (FHUT) {
00840                 <span class="comment">// keep going up the tree</span>
00841                 <span class="keywordflow">if</span> (HUT) {
00842                     <span class="keywordflow">return</span> ;
00843 
00844                     <span class="comment">// reached start of HUT, so stop generation of subtree</span>
00845                     <span class="comment">// rooted at this node</span>
00846                 } <span class="keywordflow">else</span> {
00847                     FHUT = <span class="keyword">false</span>;
00848                     <span class="keywordflow">break</span>;
00849                 }
00850             }
00851 
00852             <span class="comment">// Move on the next tail element</span>
00853             iTAIL++;
00854         }
00855     }
00856 
00857     <span class="comment">// if this is a FHUT</span>
00858     <span class="keywordflow">if</span> (<a class="code" href="group__CommandLineParameters.html#a12">GoFHUT</a> &amp;&amp; HUT &amp;&amp; AllFreq) {
00859         FHUT = <span class="keyword">true</span>;
00860         <a class="code" href="group__CounterVariables.html#a0">CountFHUT</a>++;
00861     }
00862 
00863     <span class="comment">// if this node is childless and not in MFI</span>
00864     <span class="keywordflow">if</span> (MethodIsFI)
00865         <a class="code" href="group__AlgorithmicComponents.html#a1">AddToFI</a>(C);
00866     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__CommandLineParameters.html#a5">MethodIsFCI</a> &amp;&amp; C != Root)
00867         <a class="code" href="group__AlgorithmicComponents.html#a3">AddToFCI</a>(C);
00868     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (NoChild &amp;&amp; !<a class="code" href="group__AlgorithmicComponents.html#a0">LMFISuperSet</a>(C)) {
00869         <a class="code" href="group__AlgorithmicComponents.html#a2">AddToMFI</a>(C);
00870     }
00871 
00872     <span class="keywordtype">int</span> subtreeSize = <a class="code" href="group__CounterVariables.html#a1">CountNodes</a> - beforeCountNodes + 1;
00873     <span class="keywordtype">int</span> estimateTail = (int)(frequentTailSize / (double)<a class="code" href="group__ProgramVariables.html#a9">EstimateDiv</a>);
00874     <span class="keywordflow">if</span> (estimateTail &gt; 0 &amp;&amp; C-&gt;<a class="code" href="classTreeNode.html#TreeNodem1">Trans</a>-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a> != <a class="code" href="group__CommandLineParameters.html#a7">TransCount</a>) {
00875         EstimateBuffy[estimateTail].<a class="code" href="classSubtreeEstimate.html#SubtreeEstimatem0">Count</a>++;
00876         EstimateBuffy[estimateTail].<a class="code" href="classSubtreeEstimate.html#SubtreeEstimatem1">Sum</a> += subtreeSize;
00877     }
00878 }
00879 
00880 <span class="comment"></span>
00881 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
00882 <span class="comment">/// Merge repeated itemsets into one combined itemset</span>
00883 <span class="comment">///    - e.g. if (transaction set of item 4) AND</span>
00884 <span class="comment">///    (transaction set item 5) = (transaction set item 5),</span>
00885 <span class="comment">///    then item 5 is a duplicate of item 4</span>
00886 <span class="comment">///    due to increasing support</span>
00887 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
<a name="l00888"></a><a class="code" href="group__AlgorithmicComponents.html#a9">00888</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="group__AlgorithmicComponents.html#a9">MergeRepeatedItemsets</a>() {
00889     NodeList::iterator bali = <a class="code" href="group__DataVariables.html#a0">F1</a>.begin();
00890     <a class="code" href="classBitmap.html">Bitmap</a> out(*(*bali)-&gt;Trans);
00891     <span class="keywordtype">int</span> blah = 0;
00892 
00893     <span class="comment">// for each frequent 1-itemset</span>
00894     <span class="keywordflow">while</span> (bali != <a class="code" href="group__DataVariables.html#a0">F1</a>.end()) {
00895         out.<a class="code" href="group__BitmapProcessing.html#a4">FillOnes</a>();
00896         NodeList::iterator noli = bali;
00897         noli++;
00898 
00899         <span class="comment">// search for a copy of the itemset's transaction set</span>
00900         <span class="keywordflow">while</span> (noli != <a class="code" href="group__DataVariables.html#a0">F1</a>.end()) {
00901             <span class="comment">// stop when count is no longer the same</span>
00902             <span class="keywordflow">if</span> ((*bali)-&gt;Trans-&gt;_count != (*noli)-&gt;Trans-&gt;_count)
00903                 <span class="keywordflow">break</span>;
00904             <span class="keywordflow">else</span> {
00905                 <span class="comment">// AND itemsets with the same count</span>
00906                 out.<a class="code" href="group__BitmapProcessing.html#a7">AndOnly</a>(*(*bali)-&gt;Trans, *(*noli)-&gt;Trans, <a class="code" href="group__CounterVariables.html#a3">CountAnds</a>);
00907                 out.<a class="code" href="classBitmap.html#Bitmapl0">Count</a>(blah);
00908 
00909                 <span class="comment">// check for a duplicate</span>
00910                 <span class="keywordflow">if</span> (out.<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a> == (*noli)-&gt;Trans-&gt;_count) {
00911                     (*bali)-&gt;Name-&gt;Or(*(*bali)-&gt;Name, *(*noli)-&gt;Name);
00912                     <a class="code" href="group__DataVariables.html#a0">F1</a>.erase(noli);
00913                 } <span class="keywordflow">else</span>
00914                     noli++;
00915             }
00916         }
00917         bali++;
00918     }
00919 }<span class="comment"></span>
00920 <span class="comment">/** @} */</span>
00921 
00922 
00923 <span class="comment">/*********************************************************************</span>
00924 <span class="comment"> MAIN</span>
00925 <span class="comment">*********************************************************************/</span><span class="comment"></span>
00926 <span class="comment">/// @defgroup MainFunction Main Function</span>
00927 <span class="comment">/// Main function for running the program</span>
00928 <span class="comment"></span><span class="comment">/** @{ */</span>
00929 <span class="comment"></span>
00930 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
00931 <span class="comment"></span><span class="comment">// main function for the program</span><span class="comment"></span>
00932 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
<a name="l00933"></a><a class="code" href="group__MainFunction.html#a0">00933</a> <span class="comment"></span>int main(int argc, char **argv) {
00934     <span class="comment">// Check parameters</span>
00935 
00936     <span class="keywordflow">if</span> (argc &lt; 5) {
00937         cerr &lt;&lt; <span class="stringliteral">"Usage: "</span> &lt;&lt; argv[0] &lt;&lt; <span class="stringliteral">" [-mfi/-fci/-fi] [min sup (percent)] "</span> &lt;&lt; endl;
00938         cerr &lt;&lt; <span class="stringliteral">"\t[-ascii/-binary] [input filename] "</span> &lt;&lt; endl;
00939         cerr &lt;&lt; <span class="stringliteral">"\t[output filename (optional)]"</span> &lt;&lt; endl;
00940         cerr &lt;&lt; <span class="stringliteral">"Ex: "</span> &lt;&lt; argv[0] &lt;&lt; <span class="stringliteral">" -mfi .5 -ascii connect4.ascii mfi.txt"</span> &lt;&lt; endl;
00941         cerr &lt;&lt; <span class="stringliteral">"Ex: "</span> &lt;&lt; argv[0] &lt;&lt; <span class="stringliteral">" -mfi .3 -binary chess.binary"</span> &lt;&lt; endl;
00942         exit(0);
00943     }
00944 
00945     <span class="comment">// time hook</span>
00946     time(&amp;<a class="code" href="group__TimingVariables.html#a0">total_start</a>);
00947 
00948     <span class="comment">// get the algorithm type</span>
00949     <a class="code" href="group__CommandLineParameters.html#a0">method</a> = argv[1];
00950 
00951     <span class="comment">// Minimum support as a fraction</span>
00952     <a class="code" href="group__CommandLineParameters.html#a8">MSF</a> = atof(argv[2]);
00953     
00954     <span class="keywordflow">if</span> (strcmp(argv[3], <span class="stringliteral">"-ascii"</span>) == 0)
00955         <a class="code" href="group__InputOutput.html#a2">F1FromFile</a>(argv[4], <span class="keyword">true</span>);
00956     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(argv[3], <span class="stringliteral">"-binary"</span>) == 0)
00957         <a class="code" href="group__InputOutput.html#a2">F1FromFile</a>(argv[4], <span class="keyword">false</span>);
00958     <span class="keywordflow">else</span> {
00959         cerr &lt;&lt; <span class="stringliteral">"File format must be -ascii or -binary"</span> &lt;&lt; endl;
00960         exit(1);
00961     }
00962 
00963     <span class="keywordflow">if</span> (argc == 6) {
00964         <a class="code" href="group__CommandLineParameters.html#a3">outputMFI</a> = <span class="keyword">true</span>;
00965         <a class="code" href="group__CommandLineParameters.html#a1">outFilename</a> = argv[5];
00966     }    
00967 
00968     <span class="comment">// Create a null node to begin the DFS tree</span>
00969     NullTrans = <span class="keyword">new</span> <a class="code" href="classBitmap.html">Bitmap</a>(<a class="code" href="group__CommandLineParameters.html#a7">TransCount</a>);
00970     NullTrans-&gt;<a class="code" href="group__BitmapProcessing.html#a4">FillOnes</a>();
00971     NullTrans-&gt;<a class="code" href="classBaseBitmap.html#Bitmapm4">_count</a> = <a class="code" href="group__CommandLineParameters.html#a7">TransCount</a>;
00972     <a class="code" href="group__GlobalVariables.html#a4">ItemSet</a> NullList;
00973 
00974     <a class="code" href="group__DataVariables.html#a15">MFIBySizes</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="Transaction_8h.html#a1">MAX_ITEMSET_SIZE</a>];
00975     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> h = 0; h &lt; <a class="code" href="Transaction_8h.html#a1">MAX_ITEMSET_SIZE</a>; h++) {
00976         <a class="code" href="group__DataVariables.html#a15">MFIBySizes</a>[h] = 0;
00977     }
00978 
00979     <span class="comment">// Set size of F1</span>
00980     <a class="code" href="group__ProgramVariables.html#a4">FullF1size</a> = <a class="code" href="group__ProgramVariables.html#a3">F1size</a> = <a class="code" href="group__DataVariables.html#a0">F1</a>.size();
00981 
00982     <span class="comment">// if F1 is not empty</span>
00983     <span class="keywordflow">if</span> (<a class="code" href="group__ProgramVariables.html#a4">FullF1size</a> != 0) {
00984 
00985         <a class="code" href="classBaseBitmap.html">BaseBitmap</a> *NullName = <span class="keyword">new</span> <a class="code" href="classBaseBitmap.html">BaseBitmap</a>(<a class="code" href="group__ProgramVariables.html#a4">FullF1size</a>);
00986         <a class="code" href="group__DataVariables.html#a10">MFI</a>.reserve(100000);
00987 
00988         <span class="keywordtype">int</span> p = 0;
00989         <a class="code" href="group__DataVariables.html#a8">ItemMap</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="group__ProgramVariables.html#a4">FullF1size</a>];
00990         <a class="code" href="group__DataVariables.html#a16">ItemsetBuffy</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="group__ProgramVariables.html#a4">FullF1size</a>];
00991 
00992         <span class="comment">// Rename items in F1</span>
00993         <span class="keywordflow">for</span> (NodeList::iterator nli = <a class="code" href="group__DataVariables.html#a0">F1</a>.begin(); nli != <a class="code" href="group__DataVariables.html#a0">F1</a>.end(); nli++) {
00994             <span class="comment">// store old itemid</span>
00995             <a class="code" href="group__DataVariables.html#a8">ItemMap</a>[p] = (*nli)-&gt;Prefix;
00996 
00997             <span class="comment">// assign new itemid</span>
00998             (*nli)-&gt;Prefix = p;
00999 
01000             <span class="comment">// assign name bitmaps</span>
01001             (*nli)-&gt;Name = <span class="keyword">new</span> BaseBitmap(<a class="code" href="group__ProgramVariables.html#a4">FullF1size</a>);
01002             (*nli)-&gt;Name-&gt;FillEmptyPosition(p);
01003             (*nli)-&gt;Name-&gt;_count = 1;
01004             p++;
01005         }
01006 
01007         <span class="comment">// handle repeated itemsets</span>
01008 
01009         <a class="code" href="group__AlgorithmicComponents.html#a9">MergeRepeatedItemsets</a>();
01010         <a class="code" href="group__ProgramVariables.html#a3">F1size</a> = <a class="code" href="group__DataVariables.html#a0">F1</a>.size();
01011 
01012         <span class="comment">// Create global tail</span>
01013         <a class="code" href="group__ProgramVariables.html#a0">maxtail</a> = <a class="code" href="group__ProgramVariables.html#a3">F1size</a> * (<a class="code" href="group__ProgramVariables.html#a3">F1size</a> + 1) / 2;
01014         gTail = <span class="keyword">new</span> <a class="code" href="classTailElement.html">TailElement</a>[<a class="code" href="group__ProgramVariables.html#a0">maxtail</a>];
01015 
01016         <span class="comment">// Create buffer for sorting</span>
01017         TailBuffy = <span class="keyword">new</span> <a class="code" href="classTailElement.html">TailElement</a>[<a class="code" href="group__ProgramVariables.html#a3">F1size</a>];
01018 
01019         <span class="comment">// Create buffer for estimating size of each subtree</span>
01020         <a class="code" href="group__ProgramVariables.html#a8">EstimateSize</a> = (int)ceil(<a class="code" href="group__ProgramVariables.html#a3">F1size</a> / (<span class="keywordtype">double</span>)<a class="code" href="group__ProgramVariables.html#a9">EstimateDiv</a>);
01021         EstimateBuffy = <span class="keyword">new</span> <a class="code" href="classSubtreeEstimate.html">SubtreeEstimate</a>[<a class="code" href="group__ProgramVariables.html#a8">EstimateSize</a>];
01022         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> estimateIndex = 0; estimateIndex &lt; <a class="code" href="group__ProgramVariables.html#a8">EstimateSize</a>; estimateIndex++) {
01023             EstimateBuffy[estimateIndex].<a class="code" href="classSubtreeEstimate.html#SubtreeEstimatem0">Count</a> = 1;
01024             EstimateBuffy[estimateIndex].<a class="code" href="classSubtreeEstimate.html#SubtreeEstimatem1">Sum</a> = estimateIndex * <a class="code" href="group__ProgramVariables.html#a9">EstimateDiv</a> * estimateIndex * <a class="code" href="group__ProgramVariables.html#a9">EstimateDiv</a> / 2;
01025         }
01026 
01027         <span class="comment">// Initialize global tail</span>
01028         <span class="keywordtype">int</span> uu;
01029         <span class="keywordflow">for</span> (uu = 0; uu &lt; <a class="code" href="group__ProgramVariables.html#a0">maxtail</a>; uu++) {
01030             gTail[uu].<a class="code" href="classTailElement.html#TailElementm1">Item</a> = -1;
01031             gTail[uu].<a class="code" href="classTailElement.html#TailElementm0">Count</a> = 0;
01032         }
01033 
01034         <span class="comment">// Fill global tail</span>
01035         <span class="keywordflow">for</span> (uu = 0; uu &lt; <a class="code" href="group__ProgramVariables.html#a3">F1size</a>; uu++) {
01036             gTail[uu].<a class="code" href="classTailElement.html#TailElementm1">Item</a> = uu;
01037             gTail[uu].<a class="code" href="classTailElement.html#TailElementm0">Count</a> = <a class="code" href="group__DataVariables.html#a0">F1</a>[uu]-&gt;Trans-&gt;_count;
01038 
01039             <span class="comment">// assign tail index</span>
01040             <a class="code" href="group__DataVariables.html#a0">F1</a>[uu]-&gt;tBegin = uu + 1;
01041             <span class="keywordflow">if</span> (uu == <a class="code" href="group__ProgramVariables.html#a3">F1size</a> - 1)
01042                 <a class="code" href="group__DataVariables.html#a0">F1</a>[uu]-&gt;tBegin = -1;
01043 
01044             TempName = <span class="keyword">new</span> BaseBitmap(<a class="code" href="group__ProgramVariables.html#a4">FullF1size</a>);
01045 
01046             <span class="comment">// add a buffer element for each item in F1</span>
01047             BaseBitmap *name = <span class="keyword">new</span> BaseBitmap(<a class="code" href="group__ProgramVariables.html#a4">FullF1size</a>);
01048             <a class="code" href="group__DataVariables.html#a2">NameBuffy</a>.push_back(name);
01049             <a class="code" href="classBitmap.html">Bitmap</a> *buff = <span class="keyword">new</span> <a class="code" href="classBitmap.html">Bitmap</a>(<a class="code" href="group__CommandLineParameters.html#a7">TransCount</a>);
01050             <a class="code" href="group__DataVariables.html#a1">TransBuffy</a>.push_back(buff);
01051             <a class="code" href="classTreeNode.html">TreeNode</a> *newNode = <span class="keyword">new</span> <a class="code" href="classTreeNode.html">TreeNode</a>();
01052             <a class="code" href="group__DataVariables.html#a3">NodeBuffy</a>.push_back(newNode);
01053         }
01054 
01055         srand(666);
01056         <span class="keywordtype">bool</span> FHUT;
01057 
01058         <span class="comment">// start algorithm timer</span>
01059         clock_t start, finish;
01060         <span class="keywordtype">double</span> duration = -1;
01061         start = clock();
01062 
01063         time(&amp;<a class="code" href="group__TimingVariables.html#a6">algorithm_start</a>);
01064 
01065         <span class="comment">// create root node and its associated tail</span>
01066         Root = <span class="keyword">new</span> <a class="code" href="classTreeNode.html">TreeNode</a>(NullName, NullTrans, 0, 0, -1, 0, <a class="code" href="group__ProgramVariables.html#a3">F1size</a>);
01067 
01068         <span class="comment">//Nothing is in MFI, so nothing is relevant</span>
01069         Root-&gt;<a class="code" href="classTreeNode.html#TreeNodem6">rBegin</a> = 0;
01070         Root-&gt;<a class="code" href="classTreeNode.html#TreeNodem7">rEnd</a> = 0;
01071 
01072         <span class="comment">// run the appropriate algorithm</span>
01073         <span class="keywordflow">if</span> (<a class="code" href="group__CommandLineParameters.html#a0">method</a>.compare(<span class="stringliteral">"-fci"</span>) == 0) {
01074             <span class="comment">//cout &lt;&lt; "running closure (FCI) algorithm..." &lt;&lt; endl;</span>
01075 
01076             <a class="code" href="group__CommandLineParameters.html#a12">GoFHUT</a> = <span class="keyword">false</span>;      <span class="comment">// FHUT flag</span>
01077             <a class="code" href="group__CommandLineParameters.html#a13">HUTMFI</a> = <span class="keyword">false</span>;      <span class="comment">// HUTMFI flag</span>
01078             <a class="code" href="group__CommandLineParameters.html#a14">PEPrune</a> = <span class="keyword">true</span>;      <span class="comment">// PEPrune flag</span>
01079             <a class="code" href="group__CommandLineParameters.html#a15">Reorder</a> = <span class="keyword">true</span>;      <span class="comment">// Reorder flag</span>
01080             <a class="code" href="group__CommandLineParameters.html#a5">MethodIsFCI</a> = <span class="keyword">true</span>;
01081 
01082             <a class="code" href="group__AlgorithmicComponents.html#a8">MAFIA</a>(Root, <span class="keyword">false</span>, FHUT, <span class="keyword">false</span>);
01083         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__CommandLineParameters.html#a0">method</a>.compare(<span class="stringliteral">"-mfi"</span>) == 0) {
01084             <span class="comment">//cout &lt;&lt; "running MFI algorithm..." &lt;&lt; endl;</span>
01085             <a class="code" href="group__CommandLineParameters.html#a12">GoFHUT</a> = <span class="keyword">true</span>;      <span class="comment">// FHUT flag</span>
01086             <a class="code" href="group__CommandLineParameters.html#a13">HUTMFI</a> = <span class="keyword">true</span>;      <span class="comment">// HUTMFI flag</span>
01087             <a class="code" href="group__CommandLineParameters.html#a14">PEPrune</a> = <span class="keyword">true</span>;     <span class="comment">// PEPrune flag</span>
01088             <a class="code" href="group__CommandLineParameters.html#a15">Reorder</a> = <span class="keyword">true</span>;     <span class="comment">// Reorder flag</span>
01089 
01090             <a class="code" href="group__AlgorithmicComponents.html#a8">MAFIA</a>(Root, <span class="keyword">true</span>, FHUT, <span class="keyword">false</span>);
01091         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="group__CommandLineParameters.html#a0">method</a>.compare(<span class="stringliteral">"-fi"</span>) == 0) {
01092             <span class="keywordflow">if</span> (outputMFI) {
01093                 <span class="comment">// open output file</span>
01094                 outFile = <span class="keyword">new</span> <a class="code" href="classItemsetOutput.html">ItemsetOutput</a>(<a class="code" href="group__CommandLineParameters.html#a1">outFilename</a>);
01095                 <span class="keywordflow">if</span> (!outFile-&gt;<a class="code" href="group__InputOutput.html#a6">isOpen</a>()) {
01096                     cerr &lt;&lt; <span class="stringliteral">"Output file not open!"</span> &lt;&lt; endl;
01097                     exit(1);
01098                 }
01099             }
01100 
01101             <span class="comment">//cout &lt;&lt; "running FI algorithm..." &lt;&lt; endl;</span>
01102             <a class="code" href="group__CommandLineParameters.html#a12">GoFHUT</a> = <span class="keyword">false</span>;      <span class="comment">// FHUT flag</span>
01103             <a class="code" href="group__CommandLineParameters.html#a13">HUTMFI</a> = <span class="keyword">false</span>;      <span class="comment">// HUTMFI flag</span>
01104             <a class="code" href="group__CommandLineParameters.html#a14">PEPrune</a> = <span class="keyword">false</span>;     <span class="comment">// PEPrune flag</span>
01105             <a class="code" href="group__CommandLineParameters.html#a15">Reorder</a> = <span class="keyword">false</span>;     <span class="comment">// Reorder flag</span>
01106             <a class="code" href="group__CommandLineParameters.html#a4">MethodIsFI</a> = <span class="keyword">true</span>;
01107 
01108             <a class="code" href="group__AlgorithmicComponents.html#a8">MAFIA</a>(Root, <span class="keyword">false</span>, FHUT, <span class="keyword">false</span>);
01109 
01110             <span class="keywordflow">if</span> (outputMFI) {
01111                 <span class="keyword">delete</span> outFile;
01112             }
01113         } <span class="keywordflow">else</span> {
01114             cerr &lt;&lt; <span class="stringliteral">"Invalid algorithm option!"</span> &lt;&lt; endl;
01115             exit(0);
01116         }
01117 
01118         finish = clock();
01119         duration = (finish - start) / (double)CLOCKS_PER_SEC;
01120 
01121         <span class="comment">//printf( "Algorithm CPU time: %.3f seconds.\n", duration );</span>
01122 
01123         time(&amp;<a class="code" href="group__TimingVariables.html#a7">algorithm_finish</a>);
01124         <a class="code" href="group__TimingVariables.html#a8">algorithm_time</a> = difftime(<a class="code" href="group__TimingVariables.html#a7">algorithm_finish</a>, <a class="code" href="group__TimingVariables.html#a6">algorithm_start</a>);
01125         printf(<span class="stringliteral">"Algorithm time:        %.2f seconds.\n"</span>, <a class="code" href="group__TimingVariables.html#a8">algorithm_time</a>);
01126     } <span class="keywordflow">else</span> {
01127         <a class="code" href="group__DataVariables.html#a15">MFIBySizes</a>[0]++;
01128     }    
01129 
01130     <span class="comment">/*</span>
01131 <span class="comment">    // Print out MFI length distribution</span>
01132 <span class="comment">    for (int sizeIndex = 0; sizeIndex &lt;= maxItemsetSize; sizeIndex++) {</span>
01133 <span class="comment">        cout &lt;&lt; sizeIndex &lt;&lt; " " &lt;&lt; MFIBySizes[sizeIndex] &lt;&lt; endl;</span>
01134 <span class="comment">    }</span>
01135 <span class="comment">    */</span>
01136 
01137     <span class="keywordflow">if</span> (<a class="code" href="group__CommandLineParameters.html#a3">outputMFI</a> &amp;&amp; !<a class="code" href="group__CommandLineParameters.html#a4">MethodIsFI</a>) {
01138         <span class="comment">// PrintMFI to a file</span>
01139         <span class="comment">//cout &lt;&lt; "Printing out the mfi..." &lt;&lt; endl;</span>
01140         time(&amp;<a class="code" href="group__TimingVariables.html#a9">print_start</a>);
01141 
01142         <a class="code" href="group__InputOutput.html#a3">PrintMFI</a>();
01143 
01144         time(&amp;<a class="code" href="group__TimingVariables.html#a10">print_finish</a>);
01145         <a class="code" href="group__TimingVariables.html#a11">print_time</a> = difftime(<a class="code" href="group__TimingVariables.html#a10">print_finish</a>, <a class="code" href="group__TimingVariables.html#a9">print_start</a>);
01146         printf(<span class="stringliteral">"Printing output time:  %.2f seconds.\n"</span>, <a class="code" href="group__TimingVariables.html#a11">print_time</a>);
01147     }
01148 
01149     time(&amp;<a class="code" href="group__TimingVariables.html#a1">total_finish</a>);
01150     <a class="code" href="group__TimingVariables.html#a2">total_time</a> = difftime(<a class="code" href="group__TimingVariables.html#a1">total_finish</a>, <a class="code" href="group__TimingVariables.html#a0">total_start</a>);
01151     printf(<span class="stringliteral">"Total time:            %.2f seconds.\n\n"</span>, <a class="code" href="group__TimingVariables.html#a2">total_time</a>);
01152 
01153     <span class="comment">// output stat data</span>
01154     cout &lt;&lt; <span class="stringliteral">"MinSup:      "</span> &lt;&lt; <a class="code" href="group__CommandLineParameters.html#a9">MS</a> &lt;&lt; endl;
01155     cout &lt;&lt; <span class="stringliteral">"TransCount:  "</span> &lt;&lt; <a class="code" href="group__CommandLineParameters.html#a7">TransCount</a> &lt;&lt; endl;
01156     cout &lt;&lt; <span class="stringliteral">"F1size:      "</span> &lt;&lt; <a class="code" href="group__ProgramVariables.html#a4">FullF1size</a> &lt;&lt; endl;
01157     cout &lt;&lt; <span class="stringliteral">"MFISize:     "</span> &lt;&lt; <a class="code" href="group__DataVariables.html#a10">MFI</a>.size() &lt;&lt; endl;
01158     cout &lt;&lt; <span class="stringliteral">"MFIAvg:      "</span> &lt;&lt; <a class="code" href="group__ProgramVariables.html#a2">MFIDepth</a> / (double) <a class="code" href="group__ProgramVariables.html#a1">MFISize</a> &lt;&lt; endl &lt;&lt; endl;
01159 
01160 <span class="preprocessor">    #ifdef DEBUG</span>
01161 <span class="preprocessor"></span>
01162     cout &lt;&lt; <span class="stringliteral">"CountNodes: "</span> &lt;&lt; <a class="code" href="group__CounterVariables.html#a1">CountNodes</a> &lt;&lt; endl;
01163     cout &lt;&lt; <span class="stringliteral">"CountAnds: "</span> &lt;&lt; <a class="code" href="group__CounterVariables.html#a3">CountAnds</a> &lt;&lt; endl;
01164     cout &lt;&lt; <span class="stringliteral">"CountSmallAnds: "</span> &lt;&lt; <a class="code" href="group__CounterVariables.html#a4">CountSmallAnds</a> &lt;&lt; endl;
01165     cout &lt;&lt; <span class="stringliteral">"CountRebuilds: "</span> &lt;&lt; <a class="code" href="group__CounterVariables.html#a9">CountRebuilds</a> &lt;&lt; endl;
01166     cout &lt;&lt; <span class="stringliteral">"CountCounts: "</span> &lt;&lt; <a class="code" href="group__CounterVariables.html#a2">CountCounts</a> &lt;&lt; endl &lt;&lt; endl;
01167     cout &lt;&lt; <span class="stringliteral">"CountFHUT:   "</span> &lt;&lt; <a class="code" href="group__CounterVariables.html#a0">CountFHUT</a> &lt;&lt; endl;
01168     cout &lt;&lt; <span class="stringliteral">"CountHUTMFI: "</span> &lt;&lt; <a class="code" href="group__CounterVariables.html#a7">CountHUTMFI</a> &lt;&lt; endl;
01169     cout &lt;&lt; <span class="stringliteral">"CountHUTMFISuccess: "</span> &lt;&lt; <a class="code" href="group__CounterVariables.html#a8">CountHUTMFISuccess</a> &lt;&lt; endl;
01170     cout &lt;&lt; <span class="stringliteral">"CountCheckPosition:   "</span> &lt;&lt; <a class="code" href="group__CounterVariables.html#a6">CountCheckPosition</a> &lt;&lt; endl;
01171     cout &lt;&lt; <span class="stringliteral">"CountPEPrunes:        "</span> &lt;&lt; <a class="code" href="group__CounterVariables.html#a5">CountPEPrunes</a> &lt;&lt; endl &lt;&lt; endl;
01172 
01173 <span class="preprocessor">    #endif</span>
01174 <span class="preprocessor"></span>
01175     <span class="keywordflow">return</span> 0;
01176 }<span class="comment"></span>
01177 <span class="comment">/** @} */</span>
01178 
01179 <span class="comment"></span>
01180 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
01181 <span class="comment">/// @mainpage MAFIA Code Documentation</span>
01182 <span class="comment">/// \image html MafiaLogo.jpg</span>
01183 <span class="comment">///</span>
01184 <span class="comment">/// \section ContactSection Contact</span>
01185 <span class="comment">/// - Manuel Calimlim (calimlim@cs.cornell.edu)</span>
01186 <span class="comment">/// - Johannes Gehrke (johannes@cs.cornell.edu)</span>
01187 <span class="comment">///</span>
01188 <span class="comment">/// \section DownloadSection Download</span>
01189 <span class="comment">/// - Main MAFIA webpage</span>
01190 <span class="comment">///   http://himalaya-tools.sourceforge.net/Mafia</span>
01191 <span class="comment">///</span>
01192 <span class="comment">/// \section LinuxCompilationSection Linux Compilation</span>
01193 <span class="comment">/// -# ./configure</span>
01194 <span class="comment">/// -# make</span>
01195 <span class="comment">///     - executable is created as 'src/mafia'</span>
01196 <span class="comment">///</span>
01197 <span class="comment">/// \section WindowsCompilationSection Windows Compilation</span>
01198 <span class="comment">/// -# Use cygwin and follow the Linux instructions</span>
01199 <span class="comment">/// or</span>
01200 <span class="comment">/// -# Use a Windows Compiler or IDE (such as Visual Studio)</span>
01201 <span class="comment">/// to compile the source code.</span>
01202 <span class="comment">///</span>
01203 <span class="comment">/// \section DirectoryStructureSection Directory Structure</span>
01204 <span class="comment">/// &lt;table border=1 cellspacing=5 cellpadding=5&gt;</span>
01205 <span class="comment">/// &lt;tr&gt;</span>
01206 <span class="comment">/// &lt;td&gt;admin/&lt;/td&gt;</span>
01207 <span class="comment">/// &lt;td&gt;Contains config files for compiling.  Should</span>
01208 <span class="comment">///     not be altered.&lt;/td&gt;</span>
01209 <span class="comment">/// &lt;/tr&gt;</span>
01210 <span class="comment">/// &lt;tr&gt;</span>
01211 <span class="comment">/// &lt;td&gt;src/&lt;/td&gt;</span>
01212 <span class="comment">/// &lt;td&gt;Contains all of source code for MAFIA&lt;/td&gt;</span>
01213 <span class="comment">/// &lt;/tr&gt;</span>
01214 <span class="comment">/// &lt;tr&gt;</span>
01215 <span class="comment">/// &lt;td&gt;src/Transaction.h</span>
01216 <span class="comment">/// &lt;br&gt;src/Transaction.cpp&lt;/td&gt;</span>
01217 <span class="comment">/// &lt;td&gt;Class for reading transactions from ASCII datasets&lt;/td&gt;</span>
01218 <span class="comment">/// &lt;/tr&gt;</span>
01219 <span class="comment">/// &lt;tr&gt;</span>
01220 <span class="comment">/// &lt;td&gt;src/ItemsetOutput.h</span>
01221 <span class="comment">/// &lt;br&gt;src/ItemsetOutput.cpp&lt;/td&gt;</span>
01222 <span class="comment">/// &lt;td&gt;Class for writing itemsets to file output&lt;/td&gt;</span>
01223 <span class="comment">/// &lt;/tr&gt;</span>
01224 <span class="comment">/// &lt;tr&gt;</span>
01225 <span class="comment">/// &lt;td&gt;src/BaseBitmap.h</span>
01226 <span class="comment">/// &lt;br&gt;src/BaseBitmap.cpp&lt;/td&gt;</span>
01227 <span class="comment">/// &lt;td&gt;Simple bitmap class for name bitmaps&lt;/td&gt;</span>
01228 <span class="comment">/// &lt;/tr&gt;</span>
01229 <span class="comment">/// &lt;tr&gt;</span>
01230 <span class="comment">/// &lt;td&gt;src/Bitmap.h</span>
01231 <span class="comment">/// &lt;br&gt;src/Bitmap.cpp&lt;/td&gt;</span>
01232 <span class="comment">/// &lt;td&gt;Main bitmap class for transaction bitmaps&lt;/td&gt;</span>
01233 <span class="comment">/// &lt;/tr&gt;</span>
01234 <span class="comment">/// &lt;tr&gt;</span>
01235 <span class="comment">/// &lt;td&gt;src/Mafia.cpp&lt;/td&gt;</span>
01236 <span class="comment">/// &lt;td&gt;Main class file with most of the MAFIA code&lt;/td&gt;</span>
01237 <span class="comment">/// &lt;/tr&gt;</span>
01238 <span class="comment">/// &lt;tr&gt;</span>
01239 <span class="comment">/// &lt;td&gt;src/Tables.h&lt;/td&gt;</span>
01240 <span class="comment">/// &lt;td&gt;Stores precomputed lookup tables (not included in</span>
01241 <span class="comment">///    documentation due to very large tables)&lt;/td&gt;</span>
01242 <span class="comment">/// &lt;/tr&gt;</span>
01243 <span class="comment">/// &lt;tr&gt;</span>
01244 <span class="comment">/// &lt;td&gt;src/TreeNode.h&lt;/td&gt;</span>
01245 <span class="comment">/// &lt;td&gt;Class for representing nodes in the search tree&lt;/td&gt;</span>
01246 <span class="comment">/// &lt;/tr&gt;</span>
01247 <span class="comment">/// &lt;tr&gt;</span>
01248 <span class="comment">/// &lt;td&gt;INSTALL&lt;/td&gt;</span>
01249 <span class="comment">/// &lt;td&gt;Generic installation instructions for Linux/Unix&lt;/td&gt;</span>
01250 <span class="comment">/// &lt;/tr&gt;</span>
01251 <span class="comment">/// &lt;tr&gt;</span>
01252 <span class="comment">/// &lt;td&gt;mafia.{kdevprj,kdevses}&lt;/td&gt;</span>
01253 <span class="comment">/// &lt;td&gt;KDevelop project files for Linux&lt;/td&gt;</span>
01254 <span class="comment">/// &lt;/tr&gt;</span>
01255 <span class="comment">/// &lt;tr&gt;</span>
01256 <span class="comment">/// &lt;td&gt;README&lt;/td&gt;</span>
01257 <span class="comment">/// &lt;td&gt;Pointer this page&lt;/td&gt;</span>
01258 <span class="comment">/// &lt;/tr&gt;</span>
01259 <span class="comment">/// &lt;/table&gt;</span>
01260 <span class="comment">///</span>
01261 <span class="comment">/// \section UsageSection Program Usage</span>
01262 <span class="comment">/// &lt;pre&gt;</span>
01263 <span class="comment">/// Usage: mafia [-mfi/-fci/-fi] [min sup (percent)]</span>
01264 <span class="comment">///         [-ascii/-binary] [input filename]</span>
01265 <span class="comment">///         [output filename (optional)]</span>
01266 <span class="comment">/// Ex: mafia -mfi .5 -ascii connect4.ascii mfi.txt</span>
01267 <span class="comment">/// Ex: mafia -mfi .3 -binary chess.binary</span>
01268 <span class="comment">/// &lt;/pre&gt;</span>
01269 <span class="comment">///</span>
01270 <span class="comment">/// \section InputSection File Input</span>
01271 <span class="comment">/// Datasets can be in ASCII or binary format.</span>
01272 <span class="comment">/// For ASCII files, the file format must be:</span>
01273 <span class="comment">/// &lt;pre&gt;</span>
01274 <span class="comment">/// [item_id_1] [item_id_2] ... [item_id_n]</span>
01275 <span class="comment">/// &lt;/pre&gt;</span>
01276 <span class="comment">///</span>
01277 <span class="comment">/// Items do not have to be sorted within each transaction.</span>
01278 <span class="comment">/// Items are separated by spaces and each transaction</span>
01279 <span class="comment">/// should end with a newline, e.g.</span>
01280 <span class="comment">/// &lt;pre&gt;</span>
01281 <span class="comment">/// 1 4 2</span>
01282 <span class="comment">/// 2 8 9 4</span>
01283 <span class="comment">/// 2 5</span>
01284 <span class="comment">/// &lt;/pre&gt;</span>
01285 <span class="comment">///</span>
01286 <span class="comment">/// For binary files, the file format must be:</span>
01287 <span class="comment">/// &lt;pre&gt;</span>
01288 <span class="comment">/// [custid][transid][number of items][itemid_1][itemid_2] ... [itemid_n]</span>
01289 <span class="comment">/// &lt;/pre&gt;</span>
01290 <span class="comment">///</span>
01291 <span class="comment">/// The custid and transid numbers are ignored at this time.</span>
01292 <span class="comment">/// Since the file is in binary format, all numbers are read</span>
01293 <span class="comment">/// as integers.</span>
01294 <span class="comment">///</span>
01295 <span class="comment">/// \section DatasetsSection Datasets</span>
01296 <span class="comment">/// Download &lt;a href="http://sourceforge.net/project/showfiles.php?group_id=72667"&gt;Datasets-ascii.tar.gz&lt;/a&gt;</span>
01297 <span class="comment">/// or &lt;a href="http://sourceforge.net/project/showfiles.php?group_id=72667"&gt;Datasets-binary.tar.gz&lt;/a&gt;</span>
01298 <span class="comment">/// for the full set of datasets used for testing:</span>
01299 <span class="comment">/// - chess.{ascii,binary}</span>
01300 <span class="comment">/// - connect4.{ascii,binary}</span>
01301 <span class="comment">/// - mushroom.{ascii,binary}</span>
01302 <span class="comment">/// - pumsb.{ascii,binary}</span>
01303 <span class="comment">/// - pumsb_star.{ascii,binary}</span>
01304 <span class="comment">///</span>
01305 <span class="comment">/// \section OutputSection Program Output</span>
01306 <span class="comment">/// The frequent itemsets outputted by the program are</span>
01307 <span class="comment">/// in ASCII form with the following format:</span>
01308 <span class="comment">/// &lt;pre&gt;</span>
01309 <span class="comment">/// [item_id_1] [item_id_2] ... [item_id_n] [(support)]</span>
01310 <span class="comment">/// &lt;/pre&gt;</span>
01311 <span class="comment">/// Ex:</span>
01312 <span class="comment">/// &lt;pre&gt;</span>
01313 <span class="comment">/// 28 64 42 60 40 29 52 58 (966)</span>
01314 <span class="comment">/// 46 64 42 3 25 9 5 48 66 56 34 62 7 36 60 40 29 52 58 (962)</span>
01315 <span class="comment">/// 39 36 40 29 52 58 (960)</span>
01316 <span class="comment">/// &lt;/pre&gt;</span>
01317 <span class="comment">/////////////////////////////////////////////////////////////////////</span>
01318 <span class="comment"></span>
</pre></div><hr><address style="align: right;"><small>Generated on Thu Dec 4 15:22:06 2003 for MAFIA by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.18 </small></address>
</body>
</html>
